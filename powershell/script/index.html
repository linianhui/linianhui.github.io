<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=google-site-verification content="X6gTMGCy1-_vb5i3aja3ZZyzPY3raiKRJp4VIhOAX24"><meta name=msvalidate.01 content="CDE7502649B75529BD0FCFE89B056E38"><title>[PowerShell] Script - Timetombs</title>
<link rel=icon type=image/svg href=/favicon.svg><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/normalize/8.0.1/normalize.min.css crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://s4.zstatic.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css crossorigin=anonymous referrerpolicy=no-referrer><link href='/asset/blog.css?time=2026-01-25T21%3a48%3a01Z%2b08%3a00' rel=stylesheet type=text/css><script src=https://s4.zstatic.net/npm/currency.js@2.0.4/dist/currency.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src=https://s4.zstatic.net/ajax/libs/moment.js/2.30.1/moment.min.js crossorigin=anonymous referrerpolicy=no-referrer></script><script src='/asset/blog.js?time=2026-01-25T21%3a48%3a01Z%2b08%3a00' type=application/javascript></script><script type=text/javascript>blog.isMobile()&&document.write('<link href="/asset/blog.mobile.css?time=2026-01-25T21%3A48%3A01Z%2B08%3A00" rel="stylesheet">')</script></head><body><div id=horizontal-progress class=horizontal-progress></div><aside id=toc class=toc><section class=toc-header><a class=toc-page-title href=/powershell/ target=_blank>[PowerShell]</a></section><section class=toc-page><a class=toc-page-title href=/powershell/help/ target=_blank>[PowerShell] Help</a></section><section class=toc-page><a class=toc-page-title href=/powershell/hyper-v/ target=_blank>[PowerShell] Hyper-V</a></section><section class="toc-page selected"><span class=toc-page-title>[PowerShell] Script</span><nav id=TableOfContents><ul><li><a href=#script-highlight-files>1 Script File List</a></li></ul></nav></section><script type=text/javascript>blog.isPC()&&blog.toggleToc()</script></aside><main class=main><header class=header><hgroup class=header-hgroup><h1 class=header-hgroup-title><a href=/>Timetombs</a></h1><h2 class=header-hgroup-subtitle>泛义的工具是文明的基础，而确指的工具却是愚人的器物</h2></hgroup><nav class=header-nav><a class=header-nav-item href=/topic/ title=专题 target=_self><i class="fa fa-folder"></i>专题</a>
<a class=header-nav-item href=/tag/ title=标签 target=_self><i class="fa fa-tags"></i>标签</a>
<a class=header-nav-item href=/archive/ title=归档 target=_self><i class="fa fa-archive"></i>归档</a>
<a class=header-nav-item href=https://linianhui.cnblogs.com title=博客园 target=_black><img src=/asset/cnblogs.favicon.svg>博客园</a>
<a class=header-nav-item href=https://github.com/linianhui/blog title=GitHub target=_black><i class="fa fa-github"></i>GitHub</a></nav><div class=header-stats><div class=stats><span>共
<i>66<sub>h</sub>
</i>/
<i>118<sub>a</sub>
</i>篇</span><div class=stats-date>，更新于 2026-01-25T21:48:01Z+08:00 by &nbsp;
<a class=git-commit href=https://github.com/linianhui/blog/commit/39b6c03faec1d2881596df2cd2436da10cdf9eef target=_blank><i class="fa fa-code-fork"></i>39b6c03</a></div></div><form class=search method=GET target=_blank action=https://www.bing.com/search><input name=q class=search-input type=search placeholder=search... results=5 onkeypress="search_param.value=search_param_site.value+this.value">
<input id=search_param_site type=hidden value="site:linianhui.github.io ">
<input name=q id=search_param type=hidden></form></div></header><main class=content><article class=article><h1 class=article-title>[PowerShell] Script</h1><div class=article-copyright><span>版权声明 - </span><a href=/copyright/cc target=_blank>CC BY-NC-SA 4.0</a></div><section class=article-meta><section class=article-date>2017-07-29 09:42，约6460字，阅读约13分钟</section><section class=article-topics><a class=article-topic href=/powershell/ title=[PowerShell] target=_blank><i class="fa fa-folder"></i>[PowerShell]</a></section><section class=article-tags><a class=article-tag href=/tag/powershell target=_blank><i class="fa fa-tag"></i>PowerShell</a>
<a class=article-tag href=/tag/ps1 target=_blank><i class="fa fa-tag"></i>ps1</a></section><section class=article-git><a class=article-git-commit href=https://github.com/linianhui/blog/commit/f5b959920f4bbd68096f521b5a817de6391648bd target=_blank><i class="fa fa-code-fork"></i>f5b9599</a>
<span class=article-git-commit-subject>add bios</span>
<span class=article-git-commit-time>2025-10-16 22:27</span>
<a class=article-git-source href=https://github.com/linianhui/blog/blob/main/src/powershell/script/index.md target=_blank><i class="fa fa-github"></i>源码</a></section></section><section class=article-content><h1 id=script-highlight-files><i id=locator-script-highlight-files class=header-locator></i>
<a href=#script-highlight-files class=article-h-a>1 Script File List</a></h1><div class=highlight-files><div class=highlight-files-header>bat文件列表</div><div class=highlight-files-list><div class=highlight-file id=hfs-0f6907f14f2ff83a2be610e30e0d8b41><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-0f6907f14f2ff83a2be610e30e0d8b41","highlight-file_opened")'>reboot-bios.bat</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/reboot-bios.bat title="下载 reboot-bios.bat" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/reboot-bios.bat title="源码 reboot-bios.bat"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bat data-lang=bat><span style=display:flex><span>shutdown /r /fw /t 0</span></span></code></pre></div></div></div></div></div><div class=highlight-files><div class=highlight-files-header>ps1文件列表</div><div class=highlight-files-list><div class=highlight-file id=hfs-a9ef0d52469cdc7702673e46f90dfff9><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-a9ef0d52469cdc7702673e46f90dfff9","highlight-file_opened")'>a.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/a.ps1 title="下载 a.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/a.ps1 title="源码 a.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>#####################################################</span>
</span></span><span style=display:flex><span><span style=color:green># current user powershell profile entry script file.</span>
</span></span><span style=display:flex><span><span style=color:green>#####################################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># params</span>
</span></span><span style=display:flex><span><span style=color:#00f>Param</span>(
</span></span><span style=display:flex><span>    [switch]$Init = $False,
</span></span><span style=display:flex><span>    [string]$GitUserName = <span style=color:#a31515>&#39;lnh&#39;</span>,
</span></span><span style=display:flex><span>    [string]$GitUserEmail = <span style=color:#a31515>&#39;lnhdyx@outlook.com&#39;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>@(
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/link.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/os.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/function.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/log.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/convert.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/env.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/file.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/git.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/vscode.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/gui.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/hosts.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/profile.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/prompt.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/sln.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/ui.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/vm.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/http.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/yaml.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/ip.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/k8s.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/docker.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/blog.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/java.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/wlan.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/directory.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/idea.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/auto-complete.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/fast-copy.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/dism.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/hiwifi.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/v2ray.ps1&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a31515>&#39;/alias.ps1&#39;</span>
</span></span><span style=display:flex><span>) | Foreach-Object { . <span style=color:#a31515>&#34;</span>$PSScriptRoot$_<span style=color:#a31515>&#34;</span> }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>if</span> ($Init) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Profile-AddScriptFile -ProfilePath $PROFILE -ScriptFilePath $PSCOMMANDPATH
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Git-SetGlobalAlias
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Git-SetGlobalConfig
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Git-SetGlobalUser -UserName $GitUserName -UserEmail $GitUserEmail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Git-GetConfig
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># Update-Help</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Git-ImportPoshGit
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># Kubernetes-ImportPSKubectlCompletion</span>
</span></span><span style=display:flex><span><span style=color:green># UI-SetDisplayOptions</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Log-NameValue -Name <span style=color:#a31515>&#39;Get-ExecutionPolicy&#39;</span> -Value $(Get-ExecutionPolicy)</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-a704c48a3d1edbcb77acd61cf47621f3><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-a704c48a3d1edbcb77acd61cf47621f3","highlight-file_opened")'>alias.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/alias.ps1 title="下载 alias.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/alias.ps1 title="源码 alias.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell alias functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name b -Value blog
</span></span><span style=display:flex><span>Set-Alias -Name bs -Value blog-server
</span></span><span style=display:flex><span>Set-Alias -Name d -Value Directory-To
</span></span><span style=display:flex><span>Set-Alias -Name dq -Value Directory-Search-Path-List-From-Quick-Access
</span></span><span style=display:flex><span>Set-Alias -Name dql -Value Directory-List-Quick-Access
</span></span><span style=display:flex><span>Set-Alias -Name c -Value VsCode-Open
</span></span><span style=display:flex><span>Set-Alias -Name i -Value Idea-Open
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name dr -Value Docker-Run
</span></span><span style=display:flex><span>Set-Alias -Name dre -Value Docker-Run-entrypoint
</span></span><span style=display:flex><span>Set-Alias -Name drs -Value Docker-Run-entrypoint-sh
</span></span><span style=display:flex><span>Set-Alias -Name drb -Value Docker-Run-entrypoint-bash
</span></span><span style=display:flex><span>Set-Alias -Name dc -Value docker-compose
</span></span><span style=display:flex><span>Set-Alias -Name dm -Value docker-machine
</span></span><span style=display:flex><span>Set-Alias -Name k -Value kubectl
</span></span><span style=display:flex><span>Set-Alias -Name mk -Value minikube
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name e -Value Gui-OpenExplorer
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name g -Value git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name gti -Value git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name hs -Value http-server
</span></span><span style=display:flex><span>Set-Alias -Name hst -Value http-server-temp
</span></span><span style=display:flex><span>Set-Alias -Name hss -Value http-server-share
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name env -Value Env-GetAllVariable
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name path -Value Env-GetPathVariavle
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name yj -Value Yaml-ToJson
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name jy -Value Yaml-FromJson
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name grep -Value Select-String
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name k8sgtp -Value Kubernetes-GetTerminatedPod
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Set-Alias -Name ja -Value Java-Arthas</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-e7669b265714e6befd9c31fb50ba6f36><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-e7669b265714e6befd9c31fb50ba6f36","highlight-file_opened")'>auto-complete.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/auto-complete.ps1 title="下载 auto-complete.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/auto-complete.ps1 title="源码 auto-complete.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/register-argumentcompleter?view=powershell-7.1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Register-ArgumentCompleter -CommandName Directory-To -ParameterName Path -ScriptBlock $__QUICK_ACCESS_DIRECTORY_SCRIPT_BLOCK
</span></span><span style=display:flex><span>Register-ArgumentCompleter -CommandName VsCode-Open -ParameterName Path -ScriptBlock $__QUICK_ACCESS_DIRECTORY_SCRIPT_BLOCK
</span></span><span style=display:flex><span>Register-ArgumentCompleter -CommandName Idea-Open -ParameterName Path -ScriptBlock $__QUICK_ACCESS_DIRECTORY_SCRIPT_BLOCK
</span></span><span style=display:flex><span>Register-ArgumentCompleter -CommandName Gui-OpenExplorer -ParameterName Path -ScriptBlock $__QUICK_ACCESS_DIRECTORY_SCRIPT_BLOCK
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Register-ArgumentCompleter -Native -CommandName winget -ScriptBlock {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span>($wordToComplete, $commandAst, $cursorPosition)
</span></span><span style=display:flex><span>    [Console]::InputEncoding = [Console]::OutputEncoding = $OutputEncoding = [System.Text.Utf8Encoding]::new()
</span></span><span style=display:flex><span>    $Local<span>:</span>word = $wordToComplete.Replace(<span style=color:#a31515>&#39;&#34;&#39;</span>, <span style=color:#a31515>&#39;&#34;&#34;&#39;</span>)
</span></span><span style=display:flex><span>    $Local<span>:</span>ast = $commandAst.ToString().Replace(<span style=color:#a31515>&#39;&#34;&#39;</span>, <span style=color:#a31515>&#39;&#34;&#34;&#39;</span>)
</span></span><span style=display:flex><span>    winget complete --word=<span style=color:#a31515>&#34;</span>$Local<span style=color:#a31515>:word&#34;</span> --commandline <span style=color:#a31515>&#34;</span>$Local<span style=color:#a31515>:ast&#34;</span> --position $cursorPosition | ForEach-Object {
</span></span><span style=display:flex><span>        [System.Management.Automation.CompletionResult]::new($_, $_, <span style=color:#a31515>&#39;ParameterValue&#39;</span>, $_)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Register-ArgumentCompleter -Native -CommandName dotnet -ScriptBlock {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span>($wordToComplete, $commandAst, $cursorPosition)
</span></span><span style=display:flex><span>    dotnet complete --position $cursorPosition $commandAst.ToString() | ForEach-Object {
</span></span><span style=display:flex><span>        [System.Management.Automation.CompletionResult]::new($_, $_, <span style=color:#a31515>&#39;ParameterValue&#39;</span>, $_)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/psreadline/get-psreadlinekeyhandler?view=powershell-7.1</span>
</span></span><span style=display:flex><span><span style=color:green># Get-PSReadLineKeyHandler</span></span></span></code></pre></div></div></div><div class=highlight-file id=hfs-34c61d297f946656d8129440150ed75f><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-34c61d297f946656d8129440150ed75f","highlight-file_opened")'>blog.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/blog.ps1 title="下载 blog.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/blog.ps1 title="源码 blog.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Hugo-Server() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34; hugo server --config hugo.yml --watch --buildDrafts --forceSyncStatic --panicOnWarning --port 13131&#34;</span>
</span></span><span style=display:flex><span>    hugo server --config hugo.yml --watch --buildDrafts --forceSyncStatic --panicOnWarning --port 13131
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Blog() {
</span></span><span style=display:flex><span>    cd d:/_code/blog
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Blog-Server() {
</span></span><span style=display:flex><span>    Blog
</span></span><span style=display:flex><span>    Hugo-Server
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-b4a500b2f4378c07aa3d1412ab781680><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-b4a500b2f4378c07aa3d1412ab781680","highlight-file_opened")'>convert.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/convert.ps1 title="下载 convert.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/convert.ps1 title="源码 convert.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Byte-Format(
</span></span><span style=display:flex><span>    [Parameter(ValueFromPipeline = $True)]
</span></span><span style=display:flex><span>    [long]$Length
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Length -lt 1KB) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> $Length.ToString(<span style=color:#a31515>&#34;#0B&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Length -lt 1MB) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$(($Length / 1KB)|Double-Half)<span style=color:#a31515>KB&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Length -lt 1GB) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$(($Length / 1MB)|Double-Half)<span style=color:#a31515>MB&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Length -lt 1TB) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$(($Length / 1GB)|Double-Half)<span style=color:#a31515>GB&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Length -lt 1PB) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$(($Length / 1TB)|Double-Half)<span style=color:#a31515>TB&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$(($Length / 1PB)|Double-Half)<span style=color:#a31515>PB&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Double-Half(
</span></span><span style=display:flex><span>    [Parameter(ValueFromPipeline = $True)]
</span></span><span style=display:flex><span>    [Double]$Value
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ([System.Math]::Floor($Value).CompareTo($Value) -eq 0) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> [System.Math]::Floor($Value)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> [System.Math]::Round($Value, 1)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Mac-Format(
</span></span><span style=display:flex><span>    [Parameter(ValueFromPipeline = $True)]
</span></span><span style=display:flex><span>    [string]$Mac
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    $Address = $Null
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ([System.Net.NetworkInformation.PhysicalAddress]::TryParse($Mac, [ref] $Address) -eq $False) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> $Null
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Hex = $Address.GetAddressBytes() | ForEach-Object { Byte-To-Hex -InputObject $_ }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> [System.String]::Join(<span style=color:#a31515>&#39;:&#39;</span>, $Hex)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Byte-To-Hex() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(ValueFromPipeline = $True)]
</span></span><span style=display:flex><span>        [byte]$InputObject
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $InputObject.ToString(<span style=color:#a31515>&#39;X2&#39;</span>);
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-66fb5f9aa2bfa22fe513bd23ff73c6b0><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-66fb5f9aa2bfa22fe513bd23ff73c6b0","highlight-file_opened")'>directory.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/directory.ps1 title="下载 directory.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/directory.ps1 title="源码 directory.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>$__QUICK_ACCESS_DIRECTORY = [System.Collections.Generic.List[PSObject]]::new();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$__QUICK_ACCESS_DIRECTORY_SCRIPT_BLOCK = {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span>($commandName, $parameterName, $wordToComplete, $commandAst, $fakeBoundParameters)
</span></span><span style=display:flex><span>    Directory-Search-Path-List-From-Quick-Access -Search $wordToComplete | ForEach-Object {
</span></span><span style=display:flex><span>        [System.Management.Automation.CompletionResult]::new($_.FullPath, $_.FullPath, <span style=color:#a31515>&#39;ParameterValue&#39;</span>, $_.FullPath)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Directory-Exists-And-Is-Directory {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Path = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Path param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (![System.IO.Directory]::Exists($Path)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>throw</span> <span style=color:#a31515>&#34;path </span>$Path<span style=color:#a31515> is not exist.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ([System.IO.File]::Exists($Path)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>throw</span> <span style=color:#a31515>&#34;path </span>$Path<span style=color:#a31515> is a file.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $TRUE;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Directory-Get-Abbr {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Name = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Name param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $Abbr = <span style=color:#a31515>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    $Words = $Name.Split(<span style=color:#a31515>&#34; _.-&#34;</span>.ToCharArray(), [System.StringSplitOptions]::RemoveEmptyEntries);
</span></span><span style=display:flex><span>    $Words | ForEach-Object {
</span></span><span style=display:flex><span>        $Abbr += $_[0];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Abbr;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Directory-ConvertToDirObject {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> ($Raw)
</span></span><span style=display:flex><span>    $FullPath = $Raw.FullName;
</span></span><span style=display:flex><span>    $Name = (Split-Path -Path $FullPath -Leaf);
</span></span><span style=display:flex><span>    $NameAbbr = (Directory-Get-Abbr -Name $Name);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Parent = (Split-Path -Path $FullPath -Parent);
</span></span><span style=display:flex><span>    $ParentName = (Split-Path -Path $Parent -Leaf);
</span></span><span style=display:flex><span>    $ParentNameAbbr = (Directory-Get-Abbr -Name $ParentName);
</span></span><span style=display:flex><span>    $Dir = New-Object PSObject -Property @{
</span></span><span style=display:flex><span>        <span style=color:green>#Raw      = $Raw;</span>
</span></span><span style=display:flex><span>        Abbr     = <span style=color:#a31515>&#34;</span>$ParentNameAbbr$NameAbbr<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>        NameAbbr = $NameAbbr;
</span></span><span style=display:flex><span>        FullPath = $FullPath;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Dir
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Directory-Add-To-Quick-Access {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Directory-Exists-And-Is-Directory -Path $Path) {
</span></span><span style=display:flex><span>        Get-ChildItem -Path $Path | ForEach-Object {
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> (Test-Path -Path $_.FullName -PathType Container) {
</span></span><span style=display:flex><span>                $__QUICK_ACCESS_DIRECTORY.Add((Directory-ConvertToDirObject -Raw $_))
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Directory-List-Quick-Access {
</span></span><span style=display:flex><span>    $__QUICK_ACCESS_DIRECTORY | Format-Table -AutoSize
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Directory-Search-Path-List-From-Quick-Access {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Search = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Search param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $ResultWithScopeIndex = [PSObject[][]]::new(10);
</span></span><span style=display:flex><span>    $__QUICK_ACCESS_DIRECTORY | ForEach-Object {
</span></span><span style=display:flex><span>        $Score = Directory-Search-Score -Dir $_ -Search $Search
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($Score -gt -1) {
</span></span><span style=display:flex><span>            $ResultWithScopeIndex[$Score] += $_
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    [array]::Reverse($ResultWithScopeIndex);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Result = [System.Collections.Generic.List[PSObject]]::new();
</span></span><span style=display:flex><span>    $ResultWithScopeIndex | ForEach-Object {
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($_ -ne $NULL) {
</span></span><span style=display:flex><span>            $Result.AddRange($_)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Result;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Directory-Search-Score {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> ($Dir, [string] $Search )
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Dir.FullPath.Contains($Search, [StringComparison]::OrdinalIgnoreCase)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> 9;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Dir.Abbr.Contains($Search, [StringComparison]::OrdinalIgnoreCase)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> 8;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Dir.NameAbbr.Contains($Search, [StringComparison]::OrdinalIgnoreCase)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> 7;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Filter-Directory-Item -Dir $Dir -Search $Search) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> 1;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> -1;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Filter-Directory-Item {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> ($Dir, [string] $Search )
</span></span><span style=display:flex><span>    $StartIndex = 0;
</span></span><span style=display:flex><span>    <span style=color:#00f>for</span> ($i = 0; $i -lt $Search.Length; $i++) {
</span></span><span style=display:flex><span>        $char = $Search[$i];
</span></span><span style=display:flex><span>        $charIndex = $Dir.FullPath.IndexOf($char, $StartIndex);
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($charIndex -eq -1) {
</span></span><span style=display:flex><span>            <span style=color:#00f>return</span> $FALSE;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>            $StartIndex = $charIndex;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $TRUE;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Directory-To {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Path = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Path param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Directory-Exists-And-Is-Directory -Path $Path) {
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;cd </span>$Path<span style=color:#a31515>&#34;</span>.ToLower()
</span></span><span style=display:flex><span>        Set-Location $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Directory-Add-To-Quick-Access -Path d:/_code/
</span></span><span style=display:flex><span>Directory-Add-To-Quick-Access -Path d:/_github/
</span></span><span style=display:flex><span>Directory-Add-To-Quick-Access -Path d:/
</span></span><span style=display:flex><span>Directory-Add-To-Quick-Access -Path d:/_app/
</span></span><span style=display:flex><span>Directory-Add-To-Quick-Access -Path d:/_cache/</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-ea8bfcaab8067b55ba759eac36df02c7><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-ea8bfcaab8067b55ba759eac36df02c7","highlight-file_opened")'>dism.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/dism.ps1 title="下载 dism.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/dism.ps1 title="源码 dism.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># FastCopy env functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Backup-Os {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $SourcePath = <span style=color:#a31515>&#39;c:\&#39;</span>,
</span></span><span style=display:flex><span>        [string] $TargetPath = <span style=color:#a31515>&#39;f:\_backup\&#39;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [string]$OsName = Dism-Get-OsName;
</span></span><span style=display:flex><span>    [string]$Date = $(Get-Date -Format <span style=color:#a31515>&#39;yyyy-MM-dd&#39;</span>);
</span></span><span style=display:flex><span>    [string]$Name = <span style=color:#a31515>&#34;</span>${OsName}<span style=color:#a31515>-</span>${Date}<span style=color:#a31515>&#34;</span>.ToLower();
</span></span><span style=display:flex><span>    [string]$ImageFile = <span style=color:#a31515>&#34;</span>${TargetPath}${OsName}<span style=color:#a31515>.wim&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CaptureImageCommand = <span style=color:#a31515>&#34;DISM /Capture-Image /CaptureDir:</span>${SourcePath}<span style=color:#a31515> /Name:</span>${Name}<span style=color:#a31515> /ImageFile:</span>${ImageFile}<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>    $GetImageCommand = <span style=color:#a31515>&#34;DISM /Get-ImageInfo /ImageFile:</span>$ImageFile<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>    $BatFilePath = <span style=color:#a31515>&#34;d:\dism-</span>${OsName}<span style=color:#a31515>.bat&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CaptureImageCommand | Out-File -FilePath $BatFilePath
</span></span><span style=display:flex><span>    $GetImageCommand | Out-File -Append -FilePath $BatFilePath
</span></span><span style=display:flex><span>    Get-Content -Path $BatFilePath
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Backup-Os-Append {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $SourcePath = <span style=color:#a31515>&#39;c:\&#39;</span>,
</span></span><span style=display:flex><span>        [string] $ImageFile
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $GetImageCommand = <span style=color:#a31515>&#34;DISM /Get-ImageInfo /ImageFile:</span>$ImageFile<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [string]$OsName = Dism-Get-OsName;
</span></span><span style=display:flex><span>    [string]$Date = $(Get-Date -Format <span style=color:#a31515>&#39;yyyy-MM-dd&#39;</span>);
</span></span><span style=display:flex><span>    [string]$Name = <span style=color:#a31515>&#34;</span>${OsName}<span style=color:#a31515>-</span>${Date}<span style=color:#a31515>&#34;</span>.ToLower();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $AppendCommand = <span style=color:#a31515>&#34;DISM /Append-Image /CaptureDir:</span>${SourcePath}<span style=color:#a31515> /Name:</span>${Name}<span style=color:#a31515> /ImageFile:</span>$ImageFile<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>    $BatFilePath = <span style=color:#a31515>&#34;d:\dism-</span>${OsName}<span style=color:#a31515>-append.bat&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $GetImageCommand | Out-File -FilePath $BatFilePath
</span></span><span style=display:flex><span>    $AppendCommand | Out-File -Append -FilePath $BatFilePath
</span></span><span style=display:flex><span>    $GetImageCommand | Out-File -Append -FilePath $BatFilePath
</span></span><span style=display:flex><span>    Get-Content -Path $BatFilePath
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Get-Image-Info {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $ImageFile
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    DISM /Get-ImageInfo /ImageFile<span>:</span>$ImageFile
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Get-Intl {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;DISM /Online /Get-Intl&#39;</span>;
</span></span><span style=display:flex><span>    DISM /Online /Get-Intl
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Get-Lang {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;Get-Culture | Format-List -Property *&#39;</span>;
</span></span><span style=display:flex><span>    Get-Culture | Format-List -Property *
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-Get-OsName {
</span></span><span style=display:flex><span>    $ComputerInfo = Get-ComputerInfo;
</span></span><span style=display:flex><span>    [string]$CsName = $ComputerInfo.CsName.Trim().ToLower();
</span></span><span style=display:flex><span>    [string]$OsName = $($($ComputerInfo.OsName.ToLower() -Replace <span style=color:#a31515>&#39;microsoft&#39;</span>, <span style=color:#a31515>&#39;&#39;</span>).Trim() -Replace <span style=color:#a31515>&#39; &#39;</span>, <span style=color:#a31515>&#39;-&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>${CsName}<span style=color:#a31515>-</span>${OsName}<span style=color:#a31515>&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.cnblogs.com/lindexi/p/17679590.html</span>
</span></span><span style=display:flex><span><span style=color:green># https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/clean-up-the-winsxs-folder?view=windows-11</span>
</span></span><span style=display:flex><span><span style=color:green># https://learn.microsoft.com/zh-cn/windows-hardware/manufacture/desktop/dism-operating-system-package-servicing-command-line-options?view=windows-11#cleanup-image</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-WinSxs-Stats {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;DISM /Online /Cleanup-Image /AnalyzeComponentStore&#39;</span>
</span></span><span style=display:flex><span>    DISM /Online /Cleanup-Image /AnalyzeComponentStore
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-WinSxs-Clean {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;DISM /online /Cleanup-Image /StartComponentCleanup&#39;</span>
</span></span><span style=display:flex><span>    DISM /online /Cleanup-Image /StartComponentCleanup
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-WinSxs-Clean-All {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;DISM /online /Cleanup-Image /StartComponentCleanup /ResetBase&#39;</span>
</span></span><span style=display:flex><span>    DISM /online /Cleanup-Image /StartComponentCleanup /ResetBase
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Dism-WinSxs-Repair {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;/Cleanup-Image /RestoreHealth /Source:X:\Sources\install.wim /LimitAccess&#39;</span>
</span></span><span style=display:flex><span>    DISM /Online /Cleanup-Image /RestoreHealth
</span></span><span style=display:flex><span>    <span style=color:green># sfc /scannow</span>
</span></span><span style=display:flex><span>    <span style=color:green># DISM /Online /Cleanup-Image /RestoreHealth /Source:wim:z:\win11\Sources\install.wim:1 /LimitAccess</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-a26a0c8682ddbabf6b00c7aad229188c><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-a26a0c8682ddbabf6b00c7aad229188c","highlight-file_opened")'>docker.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/docker.ps1 title="下载 docker.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/docker.ps1 title="源码 docker.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Docker-Run() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;docker run --rm --tty --interactive&#34;</span> $Args
</span></span><span style=display:flex><span>    docker run --rm --tty --interactive $Args
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Docker-Run-entrypoint() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;docker run --rm --tty --interactive --entrypoint&#34;</span> $Args
</span></span><span style=display:flex><span>    docker run --rm --tty --interactive --entrypoint $Args
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Docker-Run-entrypoint-sh() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;docker run --rm --tty --interactive --entrypoint sh&#34;</span> $Args
</span></span><span style=display:flex><span>    docker run --rm --tty --interactive --entrypoint sh $Args
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Docker-Run-entrypoint-bash() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;docker run --rm --tty --interactive --entrypoint bash&#34;</span> $Args
</span></span><span style=display:flex><span>    docker run --rm --tty --interactive --entrypoint bash $Args
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-fea61caef1b5125fb09a2e9194e00642><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-fea61caef1b5125fb09a2e9194e00642","highlight-file_opened")'>env.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/env.ps1 title="下载 env.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/env.ps1 title="源码 env.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell env functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[string]$APP_DIR = <span style=color:#a31515>&#39;d:\_app\&#39;</span>;
</span></span><span style=display:flex><span>[string]$HOME_DIR = <span style=color:#a31515>&#39;d:\_home&#39;</span>;
</span></span><span style=display:flex><span>[string]$LANG_DIR = <span style=color:#a31515>&#39;d:\_lang\&#39;</span>;
</span></span><span style=display:flex><span>[string]$CACHE_DIR = <span style=color:#a31515>&#39;d:\_cache\&#39;</span>;
</span></span><span style=display:flex><span>[string]$CONFIG_DIR = <span style=color:#a31515>&#39;d:\_config\&#39;</span>;
</span></span><span style=display:flex><span>[string]$DATA_DIR = <span style=color:#a31515>&#39;d:\_data\&#39;</span>;
</span></span><span style=display:flex><span>[string]$LOG_DIR = <span style=color:#a31515>&#39;d:\_log\&#39;</span>;
</span></span><span style=display:flex><span>[string]$PATH_SPLIT = <span style=color:#a31515>&#39;;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Env-TrySetVariable (
</span></span><span style=display:flex><span>    [string]$Variable = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Variable is null!&#34;</span>),
</span></span><span style=display:flex><span>    [string]$Value = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Value is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    $Target = [System.EnvironmentVariableTarget]::Machine
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># 输出旧值</span>
</span></span><span style=display:flex><span>    [string]$OldValue = [System.Environment]::GetEnvironmentVariable($Variable, $Target);
</span></span><span style=display:flex><span>    Log-Info <span style=color:#a31515>&#34;[</span>$Target<span style=color:#a31515>][</span>$Variable<span style=color:#a31515>] OLD_VALUE : &#34;</span> $OldValue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($OldValue -eq $Value) {
</span></span><span style=display:flex><span>        Log-Warn <span style=color:#a31515>&#34;[</span>$Target<span style=color:#a31515>][</span>$Variable<span style=color:#a31515>] NEW_VALUE : &#34;</span> $Value
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># 设置环境变量</span>
</span></span><span style=display:flex><span>    [System.Environment]::SetEnvironmentVariable($Variable, $Value, $Target)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># 输出新值</span>
</span></span><span style=display:flex><span>    [string]$NewValue = [System.Environment]::GetEnvironmentVariable($Variable, $Target);
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;[</span>$Target<span style=color:#a31515>][</span>$Variable<span style=color:#a31515>] NEW_VALUE : &#34;</span> $NewValue
</span></span><span style=display:flex><span>    Write-Host
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Env-TryAppendPathVariable (
</span></span><span style=display:flex><span>    [string]$Value = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Value is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    $Target = [System.EnvironmentVariableTarget]::Machine
</span></span><span style=display:flex><span>    $Variable = <span style=color:#a31515>&#39;Path&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:green># 获取旧值</span>
</span></span><span style=display:flex><span>    [string]$OldValue = [System.Environment]::GetEnvironmentVariable($Variable, $Target);
</span></span><span style=display:flex><span>    [array]$OldValueArray = $OldValue -Split $PATH_SPLIT
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># 检测是否已经存在</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($OldValueArray -Contains $Value) {
</span></span><span style=display:flex><span>        Log-Warn <span style=color:#a31515>&#34;[</span>$Target<span style=color:#a31515>][</span>$Variable<span style=color:#a31515>] EXISTS_VALUE : </span>$Value<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;[</span>$Target<span style=color:#a31515>][</span>$Variable<span style=color:#a31515>] APPEND_VALUE : </span>$Value<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># 追加新值</span>
</span></span><span style=display:flex><span>    $OldValueArray += $Value;
</span></span><span style=display:flex><span>    [string]$NewValue = $($OldValueArray | Where-Object { $_ } | Sort-Object -Unique -CaseSensitive<span>:</span>$false | Join-String -Separator $PATH_SPLIT);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable $Variable -Value $NewValue
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-TrySetAll() {
</span></span><span style=display:flex><span>    Get-Command -Name <span style=color:#a31515>&#39;Env-Set*EnvironmentVariable&#39;</span> -CommandType Function | ForEach-Object {
</span></span><span style=display:flex><span>        Log-Info <span style=color:#a31515>&#34;RUN : </span>$($_.Name)<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Invoke-Expression -Command $_.Name
</span></span><span style=display:flex><span>        Write-Host
</span></span><span style=display:flex><span>        Write-Host
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-GetAllVariable() {
</span></span><span style=display:flex><span>    Get-ChildItem ENV<span>:</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-GetPathVariavle() {
</span></span><span style=display:flex><span>    $ENV:PATH -Split $PATH_SPLIT | Sort-Object
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetXDGEnvironmentVariable() {
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;XDG_CONFIG_HOME&#39;</span> -Value $CONFIG_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;XDG_CACHE_HOME&#39;</span> -Value $CACHE_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;XDG_DATA_HOME&#39;</span> -Value $DATA_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetHomeEnvironmentVariable() {
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_D&#39;</span> -Value $HOME_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_APP&#39;</span> -Value $APP_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_APP_LOG&#39;</span> -Value $LOG_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_APP_CONFIG&#39;</span> -Value $CONFIG_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_APP_CACHE&#39;</span> -Value $CACHE_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HOME_APP_DATA&#39;</span> -Value $DATA_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/MicrosoftArchive/redis/releases</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetRedisEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_REDIS_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_redis\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_REDIS_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.mongodb.org/dl/win32/x86_64-2008plus-ssl</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetMongoDBEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_MONGO_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_mongo\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_MONGO_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.putty.org/</span>
</span></span><span style=display:flex><span><span style=color:green># https://the.earth.li/~sgtatham/putty/latest/w64/putty.zip</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetPuttyEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_PUTTY_DIR = $APP_DIR + <span style=color:#a31515>&#39;_putty\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_PUTTY_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/shadowsocks/shadowsocks-windows</span>
</span></span><span style=display:flex><span><span style=color:green># function Env-SetShadowsocksEnvironmentVariable() {</span>
</span></span><span style=display:flex><span><span style=color:green>#     $APP_SHADOWSOCKS_DIR = $APP_DIR + &#39;_shadowsocks\&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TryAppendPathVariable -Value $APP_SHADOWSOCKS_DIR</span>
</span></span><span style=display:flex><span><span style=color:green># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://adoptopenjdk.net/upstream.html</span>
</span></span><span style=display:flex><span><span style=color:green># https://developers.redhat.com/products/openjdk/download</span>
</span></span><span style=display:flex><span><span style=color:green># https://arthas.aliyun.com/arthas-boot.jar</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetJavaEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_JAVA_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_java\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_ARTHAS_BOOT_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_arthas_boot\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_JAVA_BIN_DIR = $APP_JAVA_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green>#Env-TrySetVariable -Variable &#39;JAVA_TOOL_OPTIONS&#39; -Value &#39;-Dfile.encoding=UTF-8&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;JAVA_HOME&#39;</span> -Value $APP_JAVA_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;ARTHAS_BOOT_HOME&#39;</span> -Value $APP_ARTHAS_BOOT_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_JAVA_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://golang.org/doc/install</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetGoEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_GO_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_go\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_GO_BIN_DIR = $APP_GO_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CACHE_GO_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_go\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;GOROOT&#39;</span> -Value $APP_GO_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;GOCACHE&#39;</span> -Value $CACHE_GO_DIR
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_GO_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://rubyinstaller.org/downloads/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetRubyEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_RUBY_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_ruby\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_RUBY_BIN_DIR = $APP_RUBY_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUBY_HOME&#39;</span> -Value $APP_RUBY_DIR
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_RUBY_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://nodejs.org/en/download/</span>
</span></span><span style=display:flex><span><span style=color:green># https://nodejs.org/download/release/latest/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetNodeEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_NODE_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_node\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_NODE_MODULES_DIR = $APP_NODE_DIR + <span style=color:#a31515>&#39;node_modules\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CACHE_NODE_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_node\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;NODE_PATH&#39;</span> -Value $APP_NODE_MODULES_DIR
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_NODE_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    npm config set cache $CACHE_NODE_DIR --global
</span></span><span style=display:flex><span>    npm config set registry <span style=color:#a31515>&#34;http://registry.npmmirror.com&#34;</span> --global
</span></span><span style=display:flex><span>    npm install -g cnpm --registry=http<span>:</span>//registry.npmmirror.com
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://kotlinlang.org/docs/tutorials/command-line.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetKotlinEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_KOTLIN_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_kotlin\&#39;</span>
</span></span><span style=display:flex><span>    $APP_KOTLIN_BIN_DIR = $APP_KOTLIN_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_KOTLIN_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://dotnet.github.io/</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/dotnet/core/tools/telemetry</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetNetEnvironmentVariable() {
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;DOTNET_CLI_TELEMETRY_OPTOUT&#39;</span> -Value <span style=color:#a31515>&#34;true&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.python.org/downloads/windows/</span>
</span></span><span style=display:flex><span><span style=color:green># Windows x86-64 embeddable zip file</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetPythonEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_PYTHON_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_python\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_PYTHON_SCRIPTS_DIR = $APP_PYTHON_DIR + <span style=color:#a31515>&#39;scripts\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_PYTHON_DIR
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_PYTHON_SCRIPTS_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/icsharpcode/ILSpy/releases</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetILSpyEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_ILSPY_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_ilspy\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_ILSPY_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.nuget.org/downloads</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/nuget/tools/cli-ref-environment-variables</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetNugetEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_NUGET_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_nuget\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_NUGET_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://developer.android.com/studio/releases/platform-tools.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetADBEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_ADB_DIR = $APP_DIR + <span style=color:#a31515>&#39;_adb\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_ADB_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.cpuid.com/softwares/cpu-z.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetCPUZEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_CPUZ_DIR = $APP_DIR + <span style=color:#a31515>&#39;_cpu-z\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_CPUZ_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.techpowerup.com/gpuz/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetGPUZEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_GPUZ_DIR = $APP_DIR + <span style=color:#a31515>&#39;_gpu-z\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_GPUZ_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># http://www.superpi.net/Download/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetPIEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_PI_DIR = $APP_DIR + <span style=color:#a31515>&#39;_pi\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_PI_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://maven.apache.org/</span>
</span></span><span style=display:flex><span><span style=color:green># https://maven.apache.org/settings.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetMavenEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_MAVEN_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_maven\&#39;</span>
</span></span><span style=display:flex><span>    $APP_MAVEN_BIN_DIR = $APP_MAVEN_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># for maven 1</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;MAVEN_HOME&#39;</span> -Value $APP_MAVEN_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># for maven 2 or 3</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;M2_HOME&#39;</span> -Value $APP_MAVEN_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># http://maven.apache.org/configure.html</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;MAVEN_OPTS&#39;</span> -Value <span style=color:#a31515>&#39;-Xms256m -Xmx1024m&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_MAVEN_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://maven.apache.org/configure.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetMvndEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_MVND_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_mvnd\&#39;</span>
</span></span><span style=display:flex><span>    $APP_MVND_BIN_DIR = $APP_MVND_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_MVND_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://gradle.org/releases/</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.gradle.org/current/userguide/installation.html</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.gradle.org/current/userguide/build_environment.html#sec:gradle_environment_variables</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetGradleEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_GRADLE_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_gradle\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_GRADLE_BIN_DIR = $APP_GRADLE_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CACHE_GRADLE_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_gradle\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;GRADLE_HOME&#39;</span> -Value $APP_GRADLE_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;GRADLE_USER_HOME&#39;</span> -Value $CACHE_GRADLE_DIR
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_GRADLE_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://projects.spring.io/spring-boot/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetSpringBootCliEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_SPRING_BOOT_CLI_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_spring-boot-cli\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_SPRING_BOOT_CLI_BIN_DIR = $APP_SPRING_BOOT_CLI_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_SPRING_BOOT_CLI_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># http://httpd.apache.org/download.cgi</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetHttpdEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_HTTPD_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_httpd\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_HTTPD_BIN_DIR = $APP_HTTPD_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_HTTPD_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://jmeter.apache.org/download_jmeter.cgi</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetJmeterEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_JMETER_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_jmeter\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_JMETER_BIN_DIR = $APP_JMETER_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_JMETER_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># http://nginx.org/en/download.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetNginxEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_NGINX_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_nginx\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_NGINX_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://kubernetes.io/docs/tasks/tools/install-kubectl</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetKubectlEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_KUBECTL_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_kubectl\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CONFIG_KUBECTL_DIR = $CONFIG_DIR + <span style=color:#a31515>&#39;_kubectl\&#39;</span>;
</span></span><span style=display:flex><span>    $CONFIG_KUBECTL_CONFIG_FILE = $CONFIG_KUBECTL_DIR + <span style=color:#a31515>&#39;config.yml&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;KUBECONFIG&#39;</span> -Value $CONFIG_KUBECTL_CONFIG_FILE
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_KUBECTL_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/kubernetes/minikube/releases</span>
</span></span><span style=display:flex><span><span style=color:green># function Env-SetMinikubeEnvironmentVariable() {</span>
</span></span><span style=display:flex><span><span style=color:green>#     $APP_MINIKUBE_DIR = $LANG_DIR + &#39;_minikube\&#39;;</span>
</span></span><span style=display:flex><span><span style=color:green>#     $DATA_MINIKUBE_DIR = &#39;e:\_minikube\&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;MINIKUBE_HOME&#39; -Value $DATA_MINIKUBE_DIR</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;MINIKUBE_WANTUPDATENOTIFICATION&#39; -Value &#39;false&#39;</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;MINIKUBE_WANTREPORTERRORPROMPT&#39; -Value &#39;false&#39;</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;CHANGE_MINIKUBE_NONE_USER&#39; -Value &#39;true&#39;</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TryAppendPathVariable -Value $APP_MINIKUBE_DIR</span>
</span></span><span style=display:flex><span><span style=color:green># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.docker.com/engine/reference/commandline/cli/#environment-variables</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetDockerEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_DOCKER_DIR = $APP_DIR + <span style=color:#a31515>&#39;_docker\&#39;</span>;
</span></span><span style=display:flex><span>    $CONFIG_DOCKER_DIR = $CONFIG_DIR + <span style=color:#a31515>&#39;_docker\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;DOCKER_CONFIG&#39;</span> -Value $CONFIG_DOCKER_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;DOCKER_HOST&#39;</span> -Value <span style=color:#a31515>&#39;tcp://127.0.0.1:2375&#39;</span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_DOCKER_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.docker.com/machine</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.docker.com/machine/drivers/hyper-v/</span>
</span></span><span style=display:flex><span><span style=color:green># function Env-SetDockerMachineEnvironmentVariable() {</span>
</span></span><span style=display:flex><span><span style=color:green>#     $APP_DOCKER_DIR = $APP_DIR + &#39;_docker\&#39;;</span>
</span></span><span style=display:flex><span><span style=color:green>#     $BOOT2DOCKER_ISO_DIR = &#39;file://&#39; + $APP_DOCKER_DIR + &#39;boot2docker.iso&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     $DATA_DOCKER_DIR = &#39;e:\_docker\&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;MACHINE_STORAGE_PATH&#39; -Value $DATA_DOCKER_DIR</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;MACHINE_NATIVE_SSH&#39; -Value 1</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;HYPERV_BOOT2DOCKER_URL&#39; -Value $BOOT2DOCKER_ISO_DIR</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;HYPERV_VIRTUAL_SWITCH&#39; -Value &#39;HVS&#39;</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;HYPERV_CPU_COUNT&#39; -Value 1</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;HYPERV_MEMORY&#39; -Value 1024</span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TrySetVariable -Variable &#39;HYPERV_DISK_SIZE&#39; -Value 10240</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TryAppendPathVariable -Value $APP_DOCKER_DIR</span>
</span></span><span style=display:flex><span><span style=color:green># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://helm.sh/docs</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/helm/helm-www</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/helm/helm/releases</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetHelmEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_HLEM_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_helm\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_HLEM_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/mholt/caddy</span>
</span></span><span style=display:flex><span><span style=color:green># https://caddyserver.com/docs/cli</span>
</span></span><span style=display:flex><span><span style=color:green># function Env-SetCaddyEnvironmentVariable() {</span>
</span></span><span style=display:flex><span><span style=color:green>#     $APP_CADDY_DIR = $LANG_DIR + &#39;_caddy\&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TryAppendPathVariable -Value $APP_CADDY_DIR</span>
</span></span><span style=display:flex><span><span style=color:green># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://coreos.com/os/docs/1911.5.0/overview-of-ct.html</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/coreos/container-linux-config-transpiler</span>
</span></span><span style=display:flex><span><span style=color:green># function Env-SetCoreOSEnvironmentVariable() {</span>
</span></span><span style=display:flex><span><span style=color:green>#     $APP_COREOS_DIR = $LANG_DIR + &#39;_coreos\&#39;;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green>#     Env-TryAppendPathVariable -Value $APP_COREOS_DIR</span>
</span></span><span style=display:flex><span><span style=color:green># }</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-6</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetPowerShellEnvironmentVariable() {
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;POWERSHELL_TELEMETRY_OPTOUT&#39;</span> -Value <span style=color:#a31515>&#39;true&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/v2ray/v2ray-core</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetV2RayEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_V2RAY_DIR = $APP_DIR + <span style=color:#a31515>&#39;_v2ray\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_V2RAY_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetLocaleEnvironmentVariable() {
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;LC_ALL&#39;</span> -Value <span style=color:#a31515>&#39;zh_CN.UTF-8&#39;</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;LANG&#39;</span> -Value <span style=color:#a31515>&#39;C.UTF-8&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.alex-is.de/PHP/fusion/downloads.php?cat_id=4&amp;download_id=9</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetASSSDBenchmarkEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_AS_SSD_BENCHMARK_DIR = $APP_DIR + <span style=color:#a31515>&#39;_as-ssd-benchmark\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_AS_SSD_BENCHMARK_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://crystalmark.info/en/download/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetDiskInfoEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_DISK_INFO_DIR = $APP_DIR + <span style=color:#a31515>&#39;_disk-info\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_DISK_INFO_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/pbatard/rufus</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetRufusEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_RUFUS_DIR = $APP_DIR + <span style=color:#a31515>&#39;_rufus\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_RUFUS_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/FFmpeg/FFmpeg</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetFFmpegEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_FFMPEG_DIR = $APP_DIR + <span style=color:#a31515>&#39;_ffmpeg\bin&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_FFMPEG_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.rust-lang.org/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetRustEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_RUSTUP_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_rustup\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_CARGO_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_cargo\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_CARGO_BIN_DIR = $APP_CARGO_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># https://github.com/rust-lang/rustup.rs#environment-variables</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUSTUP_HOME&#39;</span> -Value $APP_RUSTUP_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUSTUP_DIST_SERVER&#39;</span> -Value <span style=color:#a31515>&#39;http://mirrors.ustc.edu.cn/rust-static&#39;</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUSTUP_UPDATE_ROOT&#39;</span> -Value <span style=color:#a31515>&#39;http://mirrors.ustc.edu.cn/rust-static/rustup&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># https://github.com/rust-lang/cargo/blob/master/src/doc/src/reference/environment-variables.md</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;CARGO_HOME&#39;</span> -Value $APP_CARGO_DIR
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUST_BACKTRACE&#39;</span> -Value <span style=color:#a31515>&#39;full&#39;</span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;RUST_TEST_NOCAPTURE&#39;</span> -Value <span style=color:#a31515>&#39;0&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_CARGO_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/gohugoio/hugo</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetHugoEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_HUGO_DIR = $APP_DIR + <span style=color:#a31515>&#39;_hugo\&#39;</span>;
</span></span><span style=display:flex><span>    $CACHE_HUGO_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_hugo\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_HUGO_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;HUGO_CACHEDIR&#39;</span> -Value $CACHE_HUGO_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://developer.mozilla.org/en-US/docs/Mozilla/Projects/NSS/Key_Log_Format</span>
</span></span><span style=display:flex><span><span style=color:green># https://wiki.wireshark.org/TLS</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetSslKeyLogFileEnvironmentVariable() {
</span></span><span style=display:flex><span>    $CACHE_SSL_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_ssl\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $SSLKEYLOGFILE = $CACHE_SSL_DIR + <span style=color:#a31515>&#39;ssl.log&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;SSLKEYLOGFILE&#39;</span> -Value $SSLKEYLOGFILE
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://dev.mysql.com/downloads/mysql/</span>
</span></span><span style=display:flex><span><span style=color:green># https://dev.mysql.com/doc/refman/8.0/en/windows-install-archive.html</span>
</span></span><span style=display:flex><span><span style=color:green># https://dev.mysql.com/doc/refman/8.0/en/environment-variables.html</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetMySqlEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_MYSQL_DIR = $LANG_DIR + <span style=color:#a31515>&#39;_mysql\&#39;</span>;
</span></span><span style=display:flex><span>    $CACHE_MYSQL_DIR = $CACHE_DIR + <span style=color:#a31515>&#39;_mysql\&#39;</span>;
</span></span><span style=display:flex><span>    $DATA_MYSQL_DIR = $DATA_DIR + <span style=color:#a31515>&#39;_mysql\&#39;</span>;
</span></span><span style=display:flex><span>    $APP_MYSQL_BIN_DIR = $APP_MYSQL_DIR + <span style=color:#a31515>&#39;bin\&#39;</span>;
</span></span><span style=display:flex><span>    $MYSQL_HISTFILE = $CACHE_MYSQL_DIR + <span style=color:#a31515>&#39;.history&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;MYSQL_HOME&#39;</span> -Value $APP_MYSQL_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;MYSQL_DATA&#39;</span> -Value $DATA_MYSQL_DIR
</span></span><span style=display:flex><span>    Env-TrySetVariable -Variable <span style=color:#a31515>&#39;MYSQL_HISTFILE&#39;</span> -Value $MYSQL_HISTFILE
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_MYSQL_BIN_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/svenstaro/miniserve</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetMiniServeEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_MINISERVE_DIR = $APP_DIR + <span style=color:#a31515>&#39;_miniserve\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_MINISERVE_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/wagoodman/dive</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetDiveEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_DIVE_DIR = $APP_DIR + <span style=color:#a31515>&#39;_dive\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_DIVE_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.voidtools.com/zh-cn/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetEverythingEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_EVERYTHING_DIR = $APP_DIR + <span style=color:#a31515>&#39;_everything\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_EVERYTHING_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># iperf2 https://sourceforge.net/projects/iperf2/</span>
</span></span><span style=display:flex><span><span style=color:green># iperf3 https://iperf.fr/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetIperfEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_IPERF_DIR = $APP_DIR + <span style=color:#a31515>&#39;_iperf\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_IPERF_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://download.sysinternals.com/files/SysinternalsSuite.zip</span>
</span></span><span style=display:flex><span><span style=color:green># https://learn.microsoft.com/zh-cn/sysinternals/downloads/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetSysinternalsEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_SYSINTERNALS_DIR = $APP_DIR + <span style=color:#a31515>&#39;_sysinternals\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_SYSINTERNALS_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/winscp/winscp</span>
</span></span><span style=display:flex><span><span style=color:green># https://winscp.net/eng/index.php</span>
</span></span><span style=display:flex><span><span style=color:green># https://winscp.net/download/WinSCP-6.5.2-Portable.zip/download</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetWinScpEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_WINSCP_DIR = $APP_DIR + <span style=color:#a31515>&#39;_winscp\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_WINSCP_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/hacdias/webdav</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/hacdias/webdav/releases/download/v5.8.0/windows-amd64-webdav.zip</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetWebDavEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_WEBDAV_DIR = $APP_DIR + <span style=color:#a31515>&#39;_webdav\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_WEBDAV_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/sigoden/dufs</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/sigoden/dufs/releases/download/v0.43.0/dufs-v0.43.0-x86_64-pc-windows-msvc.zip</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetDuFsEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_DUFS_DIR = $APP_DIR + <span style=color:#a31515>&#39;_dufs\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_DUFS_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.sftpgo.com/</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/drakkan/sftpgo</span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/drakkan/sftpgo/releases/download/v2.6.6/sftpgo_v2.6.6_windows_portable.zip</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetSFTPGoEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_SFTOPGO_DIR = $APP_DIR + <span style=color:#a31515>&#39;_sftpgo\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_SFTOPGO_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.hibitsoft.ir/</span>
</span></span><span style=display:flex><span><span style=color:green># https://www.hibitsoft.ir/HiBitUninstaller/HiBitUninstaller-Portable-3.2.70.zip</span>
</span></span><span style=display:flex><span><span style=color:green># https://www.hibitsoft.ir/HibitStartup/HiBitStartupManager-Portable-2.6.60.zip</span>
</span></span><span style=display:flex><span><span style=color:green># https://www.hibitsoft.ir/HiBitSysynfo/HiBitSysInfo-Portable-2.1.30.zip</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetOtherEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_HIBIT_DIR = $APP_DIR + <span style=color:#a31515>&#39;_hibit\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_HIBIT_DIR
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># 杂项工具</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Env-SetOtherEnvironmentVariable() {
</span></span><span style=display:flex><span>    $APP_OTHER_DIR = $APP_DIR + <span style=color:#a31515>&#39;_other\&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Env-TryAppendPathVariable -Value $APP_OTHER_DIR
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-a1a1013e2829dd8e82d2d900fce96741><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-a1a1013e2829dd8e82d2d900fce96741","highlight-file_opened")'>fast-copy.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/fast-copy.ps1 title="下载 fast-copy.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/fast-copy.ps1 title="源码 fast-copy.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># FastCopy env functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span>($source, $target)
</span></span><span style=display:flex><span>    $fcpPath = <span style=color:#a31515>&#39;c:\_fast-copy\fastcopy.exe&#39;</span>;
</span></span><span style=display:flex><span>    $option = <span style=color:#a31515>&#39;/cmd=diff /open_window /estimate /balloon /error_stop=FALSE /speed=full /stream /acl&#39;</span>;
</span></span><span style=display:flex><span>    $commonExclude=<span style=color:#a31515>&#39;\$RECYCLE.BIN\;\System Volume Information\;\Recovery\;&#39;</span>;
</span></span><span style=display:flex><span>    $exclude = <span style=color:#a31515>&#34;/exclude=&#39;\_app2\;\_cache\;\_code\;\_data\;\_github\;\_lang\;\_vhd\;\_video2\;</span>$commonExclude<span style=color:#a31515>&#39;&#34;</span>;
</span></span><span style=display:flex><span>    $command = <span style=color:#a31515>&#34;</span>$fcpPath<span style=color:#a31515> </span>$option<span style=color:#a31515> </span>$exclude<span style=color:#a31515> </span><span style=color:#a31515>`&#34;</span>$source<span style=color:#a31515>`&#34;</span><span style=color:#a31515> /to=</span><span style=color:#a31515>`&#34;</span>$target<span style=color:#a31515>`&#34;</span><span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    Log-Debug $command
</span></span><span style=display:flex><span>    Invoke-Expression $command
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-Driver {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span>($driver, $targetDir)
</span></span><span style=display:flex><span>    PS-Fast-Copy -source <span style=color:#a31515>&#34;</span>${driver}<span style=color:#a31515>:\&#34;</span> -target <span style=color:#a31515>&#34;y:\</span>${targetDir}<span style=color:#a31515>\&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-Home {
</span></span><span style=display:flex><span>    PS-Fast-Copy-Driver -driver d -targetDir _home
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-Blob {
</span></span><span style=display:flex><span>    PS-Fast-Copy-Driver -driver e -targetDir _blob
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-Mirror {
</span></span><span style=display:flex><span>    PS-Fast-Copy-Driver -driver f -targetDir _mirror
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-Media {
</span></span><span style=display:flex><span>    PS-Fast-Copy-Driver -driver g -targetDir _media
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> PS-Fast-Copy-All {
</span></span><span style=display:flex><span>    PS-Fast-Copy-Home
</span></span><span style=display:flex><span>    PS-Fast-Copy-Blob
</span></span><span style=display:flex><span>    PS-Fast-Copy-Mirror
</span></span><span style=display:flex><span>    PS-Fast-Copy-Media
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-8f1ef53698ba65e535ad8fc0dbbd42e5><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-8f1ef53698ba65e535ad8fc0dbbd42e5","highlight-file_opened")'>file.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/file.ps1 title="下载 file.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/file.ps1 title="源码 file.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell file functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> File-GetBigFiles ([int]$top = 20) {
</span></span><span style=display:flex><span>    $begin = Get-Date
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;begin...&#34;</span> $begin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Get-ChildItem -Path $(Get-Location) -File -Recurse |
</span></span><span style=display:flex><span>    Sort-Object Length -Descending |
</span></span><span style=display:flex><span>    Select-Object -First $top |
</span></span><span style=display:flex><span>    Format-Table -Property @{Label = <span style=color:#a31515>&#34;Size&#34;</span>; Expression = { ($_.Length / 1MB).ToString((<span style=color:#a31515>&#39;0.000&#39;</span>)) + <span style=color:#a31515>&#39;MB&#39;</span> } }, FullName -Wrap
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $end = Get-Date
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;end...&#34;</span> $end
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;elapsed times&#34;</span> ($end - $begin)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> File-GetAll {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path = $(Get-Location)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Get-ChildItem -Path $Path -Directory | ForEach-Object {
</span></span><span style=display:flex><span>        File-GetAll -Path $_
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Get-ChildItem -Path $Path -File | ForEach-Object {
</span></span><span style=display:flex><span>        $_.FullName
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> File-Diff {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $PartFile,
</span></span><span style=display:flex><span>        [string] $FullFile
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $PartContent = $(Get-Content $PartFile)
</span></span><span style=display:flex><span>    Get-Content -Path $FullFile | ForEach-Object {
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($PartContent.Contains($_) -eq $FALSE) {
</span></span><span style=display:flex><span>            $_
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-e6e546d8c70ed639f9658b343ef6e108><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-e6e546d8c70ed639f9658b343ef6e108","highlight-file_opened")'>function.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/function.ps1 title="下载 function.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/function.ps1 title="源码 function.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Read-Host-With-Default {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [String]$Prompt,
</span></span><span style=display:flex><span>        [String]$DefaultValue
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $Input = Read-Host -Prompt <span style=color:#a31515>&#34;</span>$Prompt<span style=color:#a31515>,default </span>$DefaultValue<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    $Input = (-not($input))?<span style=color:#a31515>&#34;</span>$DefaultValue<span style=color:#a31515>&#34;</span><span>:</span><span style=color:#a31515>&#34;</span>$Input<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    Write-host <span style=color:#a31515>&#34;</span>$Prompt<span style=color:#a31515> </span>$Input<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Input
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-9c16c765229165fae1c0f8e14f4f1f97><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-9c16c765229165fae1c0f8e14f4f1f97","highlight-file_opened")'>git.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/git.ps1 title="下载 git.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/git.ps1 title="源码 git.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># git functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># import posh-git module</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-ImportPoshGit () {
</span></span><span style=display:flex><span>    Import-Module posh-git
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># install posh-git module</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-InstallPoshGit () {
</span></span><span style=display:flex><span>    Install-Module posh-git
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># recurse git pull rebase</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-Pull-Rebase-Recurse () {
</span></span><span style=display:flex><span>    Get-ChildItem -Attributes Directory -Path (Get-Location) | ForEach-Object {
</span></span><span style=display:flex><span>        $Path = $_.FullName.ToLower()
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;</span><span style=color:#a31515>`n</span><span style=color:#a31515>cd </span>$Path<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Set-Location $Path
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#39;git remote -v&#39;</span>
</span></span><span style=display:flex><span>        git remote -v
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#39;git symbolic-ref HEAD&#39;</span>
</span></span><span style=display:flex><span>        git symbolic-ref HEAD
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;git pull --rebase&#34;</span>
</span></span><span style=display:flex><span>        git pull --rebase
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Set-Location -Path ..
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-Warn-GC () {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;git reflog expire --expire=now --all&#34;</span>
</span></span><span style=display:flex><span>    git warn-expire-reflog
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;git gc --prune=now --aggressive&#34;</span>
</span></span><span style=display:flex><span>    git warn-gc-now
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;git count-objects -v -H&#34;</span>
</span></span><span style=display:flex><span>    git size
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-Warn-GC-Recurse () {
</span></span><span style=display:flex><span>    Get-ChildItem -Attributes Directory -Path (Get-Location) | ForEach-Object {
</span></span><span style=display:flex><span>        $Path = $_.FullName.ToLower()
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;</span><span style=color:#a31515>`n</span><span style=color:#a31515>cd </span>$Path<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Set-Location $Path
</span></span><span style=display:flex><span>        Git-Warn-GC
</span></span><span style=display:flex><span>        Set-Location -Path ..
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-Size-Recurse () {
</span></span><span style=display:flex><span>    Get-ChildItem -Attributes Directory -Path (Get-Location) | ForEach-Object {
</span></span><span style=display:flex><span>        $Path = $_.FullName.ToLower()
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;</span><span style=color:#a31515>`n</span><span style=color:#a31515>git -C &#39;</span>$Path<span style=color:#a31515>&#39; count-objects -v -H&#34;</span>
</span></span><span style=display:flex><span>        git -C <span style=color:#a31515>&#34;</span>$Path<span style=color:#a31515>&#34;</span> size
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Git-GetAllObjects () {
</span></span><span style=display:flex><span>    $gitObjects = git rev-list --objects --all | git cat-file --batch-check=<span style=color:#a31515>&#39;%(objecttype)|%(objectname)|%(objectsize)|%(rest)&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $gitObjects
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Git-ConvertToPSObject ($object) {
</span></span><span style=display:flex><span>    $row = $object.Split(<span style=color:#a31515>&#39;|&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $gitObject = New-Object PSObject -Property @{
</span></span><span style=display:flex><span>        type = $row[0];
</span></span><span style=display:flex><span>        sha  = $row[1];
</span></span><span style=display:flex><span>        size = [int]($row[2]);
</span></span><span style=display:flex><span>        path = $row[3];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $gitObject
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Git-GetAllBlobObjects () {
</span></span><span style=display:flex><span>    $gitBlobObjects = @()
</span></span><span style=display:flex><span>    Git-GetAllObjects | Foreach-Object {
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($_.StartsWith(<span style=color:#a31515>&#39;blob&#39;</span>)) {
</span></span><span style=display:flex><span>            $gitBlobObjects += (Git-ConvertToPSObject $_)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $gitBlobObjects
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-GetBigFiles([int]$top = 20) {
</span></span><span style=display:flex><span>    $begin = Get-Date
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;begin...&#34;</span> $begin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Git-GetAllBlobObjects |
</span></span><span style=display:flex><span>    Sort-Object size -Descending |
</span></span><span style=display:flex><span>    Select-Object -First $top |
</span></span><span style=display:flex><span>    Format-Table -Property sha, @{Label = <span style=color:#a31515>&#34;size&#34;</span>; Expression = { ($_.size / 1MB).ToString((<span style=color:#a31515>&#39;0.000&#39;</span>)) + <span style=color:#a31515>&#39;MB&#39;</span> } }, path -Wrap
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $end = Get-Date
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;end...&#34;</span> $end
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;elapsed times&#34;</span> ($end - $begin)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-SetGlobalAlias () {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># checkout</span>
</span></span><span style=display:flex><span>    git config --global alias.co checkout
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># commit</span>
</span></span><span style=display:flex><span>    git config --global alias.ci commit
</span></span><span style=display:flex><span>    git config --global alias.alc <span style=color:#a31515>&#39;commit --amend --no-edit&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># status</span>
</span></span><span style=display:flex><span>    git config --global alias.st <span style=color:#a31515>&#39;status --short --branch&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># branch</span>
</span></span><span style=display:flex><span>    git config --global alias.br branch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># pull</span>
</span></span><span style=display:flex><span>    git config --global alias.pr <span style=color:#a31515>&#39;pull --rebase&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># merge</span>
</span></span><span style=display:flex><span>    git config --global alias.mnf <span style=color:#a31515>&#39;merge --no-ff&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># diff</span>
</span></span><span style=display:flex><span>    git config --global alias.d diff
</span></span><span style=display:flex><span>    git config --global alias.dt difftool
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># cherry-pick</span>
</span></span><span style=display:flex><span>    git config --global alias.cp cherry-pick
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># log</span>
</span></span><span style=display:flex><span>    git config --global alias.last <span style=color:#a31515>&#39;log -1&#39;</span>
</span></span><span style=display:flex><span>    git config --global alias.lg <span style=color:#a31515>&#34;log --color --graph --pretty=format:&#39;%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)&lt;%an&gt;%Creset&#39; --abbrev-commit&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># count-objects</span>
</span></span><span style=display:flex><span>    git config --global alias.size <span style=color:#a31515>&#39;count-objects -v -H&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># reflog</span>
</span></span><span style=display:flex><span>    git config --global alias.rl <span style=color:#a31515>&#34;reflog --format=&#39;%cd %h %gs&#39; --date=format:&#39;%Y-%m-%d %H:%M:%S&#39;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># gc</span>
</span></span><span style=display:flex><span>    git config --global alias.warn-expire-reflog <span style=color:#a31515>&#34;reflog expire --expire=now --all&#34;</span>
</span></span><span style=display:flex><span>    git config --global alias.warn-gc-now <span style=color:#a31515>&#34;gc --prune=now --aggressive&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># chmod +/- x</span>
</span></span><span style=display:flex><span>    git config --global alias.chmod644 <span style=color:#a31515>&#34;update-index --chmod=-x&#34;</span>
</span></span><span style=display:flex><span>    git config --global alias.chmod755 <span style=color:#a31515>&#34;update-index --chmod=+x&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># head</span>
</span></span><span style=display:flex><span>    git config --global alias.head <span style=color:#a31515>&#39;symbolic-ref HEAD&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># set global config</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-SetGlobalConfig () {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    git config --global init.defaultBranch main
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># gui</span>
</span></span><span style=display:flex><span>    git config --global gui.encoding <span style=color:#a31515>&#39;utf-8&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># i18n</span>
</span></span><span style=display:flex><span>    git config --global i18n.commitencoding <span style=color:#a31515>&#39;utf-8&#39;</span>
</span></span><span style=display:flex><span>    git config --global core.quotepath false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># editor</span>
</span></span><span style=display:flex><span>    git config --global core.editor <span style=color:#a31515>&#34;code -w&#34;</span>
</span></span><span style=display:flex><span>    git config --global core.autocrlf false
</span></span><span style=display:flex><span>    git config --global core.safecrlf true
</span></span><span style=display:flex><span>    git config --global core.filemode false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># color</span>
</span></span><span style=display:flex><span>    git config --global color.ui true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># branch pager</span>
</span></span><span style=display:flex><span>    git config --global pager.branch false
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># set git global user</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-SetGlobalUser (
</span></span><span style=display:flex><span>    [string] $UserName = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;UserName is null!&#34;</span>),
</span></span><span style=display:flex><span>    [string] $UserEmail = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;UserEmail is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    git config --global user.name $UserName
</span></span><span style=display:flex><span>    git config --global user.email $UserEmail
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># get git user</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-GetCurrentUser () {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $UserName = git config user.name
</span></span><span style=display:flex><span>    $UserEmail = git config user.email
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$UserName<span style=color:#a31515>@&lt;</span>$UserEmail<span style=color:#a31515>&gt;&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># git get config</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-GetConfig ([string]$Name) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Name) {
</span></span><span style=display:flex><span>        $Values = git config --get-all $Name
</span></span><span style=display:flex><span>        $LocalValues = git config --get-all --local $Name
</span></span><span style=display:flex><span>        $GlobalValues = git config --get-all --global $Name
</span></span><span style=display:flex><span>        $SystemValues = git config --get-all --system $Name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Write-Host <span style=color:#a31515>&#34;name   : </span>$Name<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>        Write-Host <span style=color:#a31515>&#34;value  : </span>$Values<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>        Write-Host <span style=color:#a31515>&#34;local  : </span>$LocalValues<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>        Write-Host <span style=color:#a31515>&#34;global : </span>$GlobalValues<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>        Write-Host <span style=color:#a31515>&#34;system : </span>$SystemValues<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        git config --list | Sort-Object
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Git-Proxy(
</span></span><span style=display:flex><span>    [switch]$set = $False,
</span></span><span style=display:flex><span>    [switch]$get = $True,
</span></span><span style=display:flex><span>    [switch]$unset = $False
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($set) {
</span></span><span style=display:flex><span>        git config --global http.proxy <span style=color:#a31515>&#39;socks5://192.168.2.123:1080&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($unset) {
</span></span><span style=display:flex><span>        git config --global --unset http.proxy
</span></span><span style=display:flex><span>        git config --global --unset https.proxy
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    git config --global --get http.proxy
</span></span><span style=display:flex><span>    git config --global --get https.proxy
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-1ae0bd0fd1aca2e60d7d0fe4b7ce33e5><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-1ae0bd0fd1aca2e60d7d0fe4b7ce33e5","highlight-file_opened")'>github.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/github.ps1 title="下载 github.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/github.ps1 title="源码 github.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/benchmark-http.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/benchmark-nginx.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/blog.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/channel9-downloader.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/chrome-extensions.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/cnblogs-theme.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/code.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/code-guide.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/div.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/docker.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-aspnetcore.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-cake.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-java.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-mongodb.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-oidc.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-rabbitmq.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/example-spring.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/git-web.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/I-love-mommy.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/jvm.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/linianhui.github.io.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/networking.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/networking-programming.git
</span></span><span style=display:flex><span>git clone https<span>:</span>//github.com/linianhui/nuget-server.git</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-cf7c9f526bf7229fd5d300f753a74614><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-cf7c9f526bf7229fd5d300f753a74614","highlight-file_opened")'>gui.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/gui.ps1 title="下载 gui.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/gui.ps1 title="源码 gui.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Gui-OpenExplorer () {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Path = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Path param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Directory-Exists-And-Is-Directory -Path $Path) {
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;explorer </span>$Path<span style=color:#a31515>&#34;</span>.ToLower()
</span></span><span style=display:flex><span>        explorer $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-c8ed150a78cd308e6a65a37e353ee5ac><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-c8ed150a78cd308e6a65a37e353ee5ac","highlight-file_opened")'>hiwifi.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/hiwifi.ps1 title="下载 hiwifi.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/hiwifi.ps1 title="源码 hiwifi.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>[string]$HIWIFI_GET_UUID_PATH = <span style=color:#a31515>&#39;/cgi-bin/turbo/proxy/router_info&#39;</span>;
</span></span><span style=display:flex><span>[string]$HIWIFI_GET_LOCAL_TOKEN_PATH = <span style=color:#a31515>&#39;/local-ssh/api?method=get&#39;</span>;
</span></span><span style=display:flex><span>[string]$HIWIFI_OPEN_SSH_PATH = <span style=color:#a31515>&#39;/local-ssh/api?method=valid&amp;data=&#39;</span>;
</span></span><span style=display:flex><span>[string]$HIWIFI_CLOSE_SSH_PATH = <span style=color:#a31515>&#39;/local-ssh/api?method=stop&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> HiWifi-Open-Ssh {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $IP = <span style=color:#a31515>&#34;192.168.199.1&#34;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $CloudToken = HiWifi-Calc-CloudToken -IP $IP
</span></span><span style=display:flex><span>    $Url = <span style=color:#a31515>&#34;http://&#34;</span> + $IP + $HIWIFI_OPEN_SSH_PATH + $CloudToken
</span></span><span style=display:flex><span>    Invoke-WebRequest -Method GET -Uri $Url
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> HiWifi-Calc-CloudToken() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $IP
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $UuidUrl = <span style=color:#a31515>&#34;http://&#34;</span> + $IP + $HIWIFI_GET_UUID_PATH
</span></span><span style=display:flex><span>    $Uuid = ((Invoke-WebRequest -Method GET -Uri $UuidUrl).Content | ConvertFrom-Json).data.uuid
</span></span><span style=display:flex><span>    $LocalTokenUrl = <span style=color:#a31515>&#34;http://&#34;</span> + $IP + $HIWIFI_GET_LOCAL_TOKEN_PATH
</span></span><span style=display:flex><span>    $LocalToken = ((Invoke-WebRequest -Method GET -Uri $LocalTokenUrl).Content | ConvertFrom-Json).data
</span></span><span style=display:flex><span>    $CloudToken = HiWifi-Calc-CloudTokenCore -Uuid $Uuid -LocalToken $LocalToken
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $CloudToken;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> HiWifi-Calc-CloudTokenCore() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Uuid,
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $LocalToken
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $Key = HiWifi-Calc-CloudTokenKeyHex -Uuid $Uuid
</span></span><span style=display:flex><span>    $Data = HiWifi-Calc-CloudTokenDataUtf8 -LocalToken $LocalToken
</span></span><span style=display:flex><span>    $HmacSha1 = New-Object System.Security.Cryptography.HMACSHA1
</span></span><span style=display:flex><span>    $HmacSha1.key = [System.Convert]::FromHexString($Key)
</span></span><span style=display:flex><span>    $Hash1 = $HmacSha1.ComputeHash([System.Text.Encoding]::UTF8.GetBytes($Data))
</span></span><span style=display:flex><span>    $Result = [System.Convert]::ToBase64String($Hash1)
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Result;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> HiWifi-Calc-CloudTokenKeyHex() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Uuid
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $Stream = [System.IO.MemoryStream]::new()
</span></span><span style=display:flex><span>    $Writer = [System.IO.StreamWriter]::new($Stream)
</span></span><span style=display:flex><span>    $Writer.Write($Uuid)
</span></span><span style=display:flex><span>    $Writer.Flush()
</span></span><span style=display:flex><span>    $Stream.Position = 0
</span></span><span style=display:flex><span>    $Hash = (Get-FileHash -InputStream $Stream -Algorithm SHA1)
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Hash.Hash;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> HiWifi-Calc-CloudTokenDataUtf8() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $LocalToken
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $UsedLocalTokenBase64 = $LocalToken.Substring(0, 40);
</span></span><span style=display:flex><span>    $UsedLocalTokenBytes = [System.Convert]::FromBase64String($UsedLocalTokenBase64);
</span></span><span style=display:flex><span>    $UsedLocalTokenUtf8 = [System.Text.Encoding]::UTF8.GetString($UsedLocalTokenBytes);
</span></span><span style=display:flex><span>    $Time = $UsedLocalTokenUtf8.Substring(17, 13);
</span></span><span style=display:flex><span>    [Int64]$TimeAdd1 = [System.Convert]::ToInt64($Time) + 1;
</span></span><span style=display:flex><span>    $Result = $UsedLocalTokenUtf8.Replace($Time, $TimeAdd1.ToString());
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $Result;
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-655e625233fb32e2bba3c71f199b596b><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-655e625233fb32e2bba3c71f199b596b","highlight-file_opened")'>hosts.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/hosts.ps1 title="下载 hosts.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/hosts.ps1 title="源码 hosts.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Hosts-Edit () {
</span></span><span style=display:flex><span>  code <span style=color:#a31515>&#34;</span>$ENV:SYSTEMROOT<span style=color:#a31515>\system32\drivers\etc\hosts&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-97f3512767947e2300fb44edb7ebe79c><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-97f3512767947e2300fb44edb7ebe79c","highlight-file_opened")'>http.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/http.ps1 title="下载 http.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/http.ps1 title="源码 http.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/svenstaro/miniserve</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [ValidateSet(<span style=color:#a31515>&#39;dufs&#39;</span>, <span style=color:#a31515>&#39;miniserve&#39;</span>, <span style=color:#a31515>&#39;sftpgo&#39;</span>)]
</span></span><span style=display:flex><span>        [string] $App = <span style=color:#a31515>&#39;miniserve&#39;</span>,
</span></span><span style=display:flex><span>        [string] $Path = $((Get-Location).Path)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($App -eq <span style=color:#a31515>&#39;miniserve&#39;</span>) {
</span></span><span style=display:flex><span>        Http-Server-Mineserve -Path $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($App -eq <span style=color:#a31515>&#39;dufs&#39;</span>) {
</span></span><span style=display:flex><span>        Http-Server-Dufs -Path $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($App -eq <span style=color:#a31515>&#39;sftpgo&#39;</span>) {
</span></span><span style=display:flex><span>        Http-Server-SFTPGo -Path $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/svenstaro/miniserve</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server-Mineserve() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path = $((Get-Location).Path)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;miniserve --qrcode --upload-files --dirs-first --hide-theme-selector --enable-webdav --interfaces 192.168.2.2 </span>$Path<span style=color:#a31515> </span>$Args<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    miniserve --qrcode --upload-files --dirs-first --hide-theme-selector --enable-webdav --interfaces 192.168.2.2 $Path
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/sigoden/dufs</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server-Dufs() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path = $((Get-Location).Path)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;dufs --bind 192.168.2.2 --port 8080 --allow-all --log-file </span>${env:HOME_APP_LOG}<span style=color:#a31515>dufs.log </span>$Path<span style=color:#a31515> </span>$Args<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    dufs --bind 192.168.2.2 --port 8080 --allow-all --log-file ${env<span>:</span>HOME_APP_LOG}dufs.log $Path
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.sftpgo.com/</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server-SFTPGo() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path = $((Get-Location).Path)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;sftpgo serve --config-dir </span>${env:HOME_APP}<span style=color:#a31515>/_sftpgo </span>$Path<span style=color:#a31515> </span>$Args<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    sftpgo serve --config-dir ${env<span>:</span>HOME_APP}/_sftpgo $Path
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server-Temp() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [ValidateSet(<span style=color:#a31515>&#39;dufs&#39;</span>, <span style=color:#a31515>&#39;miniserve&#39;</span>, <span style=color:#a31515>&#39;sftpgo&#39;</span>)]
</span></span><span style=display:flex><span>        [string] $App = <span style=color:#a31515>&#39;miniserve&#39;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Http-Server -App $App -Path <span style=color:#a31515>&#39;z:/__temp&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Http-Server-Share() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [ValidateSet(<span style=color:#a31515>&#39;dufs&#39;</span>, <span style=color:#a31515>&#39;miniserve&#39;</span>, <span style=color:#a31515>&#39;sftpgo&#39;</span>)]
</span></span><span style=display:flex><span>        [string] $App = <span style=color:#a31515>&#39;miniserve&#39;</span>
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Http-Server -App $App -Path <span style=color:#a31515>&#39;z:/_share&#39;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-67e2878ac9425be94639c4bdc5bfa173><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-67e2878ac9425be94639c4bdc5bfa173","highlight-file_opened")'>idea.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/idea.ps1 title="下载 idea.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/idea.ps1 title="源码 idea.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Idea-Open {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Path = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Path param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Directory-Exists-And-Is-Directory -Path $Path) {
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;idea64 </span>$Path<span style=color:#a31515>&#34;</span>.ToLower()
</span></span><span style=display:flex><span>        idea64 $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-52526e4c2d738f35ac5d842b24ea095b><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-52526e4c2d738f35ac5d842b24ea095b","highlight-file_opened")'>ip.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/ip.ps1 title="下载 ip.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/ip.ps1 title="源码 ip.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell ip functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> IP-SET() {
</span></span><span style=display:flex><span>    <span style=color:green># show all ethernet interfaces</span>
</span></span><span style=display:flex><span>    netsh interface ipv4 show interfaces
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $defaultIdx=1
</span></span><span style=display:flex><span>    $idx = Read-Host-With-Default -Prompt <span style=color:#a31515>&#34;select interface idx&#34;</span> -DefaultValue $defaultIdx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># show selected ethernet interface address</span>
</span></span><span style=display:flex><span>    netsh interface ipv4 show address name=$idx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># set dhcp</span>
</span></span><span style=display:flex><span>    $dhcp = Read-Host-With-Default -Prompt <span style=color:#a31515>&#34;set source=[dhcp|static]&#34;</span> -DefaultValue <span style=color:#a31515>&#39;static&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (<span style=color:#a31515>&#39;dhcp&#39;</span> -ieq $dhcp) {
</span></span><span style=display:flex><span>        netsh interface ipv4 set address name=$idx source=dhcp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Write-host <span style=color:#a31515>&#34;show interface </span>$idx<span style=color:#a31515> current address&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>        netsh interface ipv4 show address name=$idx
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $defaultIP = <span style=color:#a31515>&#39;192.168.1.2&#39;</span>
</span></span><span style=display:flex><span>    $ip = Read-Host-With-Default -Prompt <span style=color:#a31515>&#39;set ip&#39;</span> -DefaultValue $defaultIP
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $defaultMask = <span style=color:#a31515>&#39;255.255.255.0&#39;</span>
</span></span><span style=display:flex><span>    $mask = Read-Host-With-Default -Prompt <span style=color:#a31515>&#39;set mask&#39;</span> -DefaultValue $defaultMask
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $defaultGateway = $defaultIP.Substring(0, $defaultIP.LastIndexOf(<span style=color:#a31515>&#39;.&#39;</span>)) + <span style=color:#a31515>&#39;.1&#39;</span>
</span></span><span style=display:flex><span>    $gateway = Read-Host-With-Default -Prompt <span style=color:#a31515>&#39;set gateway&#39;</span> -DefaultValue $defaultGateway
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    netsh interface ipv4 set address name=$idx source=static address=$ip mask=$mask gateway=$gateway
</span></span><span style=display:flex><span>    Write-host <span style=color:#a31515>&#34;netsh interface ipv4 show address name=</span>$idx<span style=color:#a31515>&#34;</span> -ForegroundColor Green
</span></span><span style=display:flex><span>    netsh interface ipv4 show address name=$idx
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> IP-Port-Forward-Add (
</span></span><span style=display:flex><span>    [int] $port,
</span></span><span style=display:flex><span>    [string] $ip
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;netsh interface portproxy add v4tov4 listenport=</span>$port<span style=color:#a31515> connectaddress=</span>$ip<span style=color:#a31515> connectport=</span>$port<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    netsh interface portproxy add v4tov4 listenport=$port connectaddress=$ip connectport=$port
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> IP-Port-Forward-Delete (
</span></span><span style=display:flex><span>    [int] $port
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;netsh interface portproxy delete v4tov4 listenport=</span>$port<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    netsh interface portproxy delete v4tov4 listenport=$port
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> IP-Port-Forward-Show (
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;netsh interface portproxy show all&#34;</span>
</span></span><span style=display:flex><span>    netsh interface portproxy show all
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-34af6de908c4e0b08329da5a20e39467><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-34af6de908c4e0b08329da5a20e39467","highlight-file_opened")'>java.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/java.ps1 title="下载 java.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/java.ps1 title="源码 java.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Java-Arthas() {
</span></span><span style=display:flex><span>    <span style=color:green># https://arthas.gitee.io/install-detail.html</span>
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;java -jar </span>${ENV:ARTHAS_BOOT_HOME}<span style=color:#a31515>arthas-boot.jar --repo-mirror aliyun --use-http </span>$ARGS<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    java -jar ${ENV<span>:</span>ARTHAS_BOOT_HOME}arthas-boot.jar --repo-mirror aliyun --use-http $ARGS
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java-Set-Jdk {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [ValidateSet(<span style=color:#a31515>&#39;8&#39;</span>, <span style=color:#a31515>&#39;11&#39;</span>, <span style=color:#a31515>&#39;17&#39;</span>, <span style=color:#a31515>&#39;21&#39;</span>)]
</span></span><span style=display:flex><span>        [string] $Version
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $BasePath = <span style=color:#a31515>&#39;d:\_lang\_java&#39;</span>
</span></span><span style=display:flex><span>    $JdkPath = $BasePath + $Version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CurrentJdkPath = (Get-Item -Path $BasePath).Target
</span></span><span style=display:flex><span>    Log-Info <span style=color:#a31515>&#34;current jdk path : </span>$CurrentJdkPath<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($JdkPath.Equals($CurrentJdkPath)) {
</span></span><span style=display:flex><span>        Log-Warn <span style=color:#a31515>&#34;not need change&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        Log-Warn <span style=color:#a31515>&#34;Remove-Item </span>$BasePath<span style=color:#a31515> -Force -Confirm:</span>$False<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Remove-Item $BasePath -Force -Confirm:$False
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        Log-Info <span style=color:#a31515>&#34;New-Item -ItemType Junction -Path </span>$BasePath<span style=color:#a31515> -Target </span>$JdkPath<span style=color:#a31515> | Out-Null&#34;</span>
</span></span><span style=display:flex><span>        Link-Soft -VirtualPath $BasePath -RealPath $JdkPath | Out-Null
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;now jdk path : </span>$((Get-Item -Path $BasePath).Target)<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    java -version
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java8 {
</span></span><span style=display:flex><span>    Java-Set-Jdk -Version 8
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java11 {
</span></span><span style=display:flex><span>    Java-Set-Jdk -Version 11
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java17 {
</span></span><span style=display:flex><span>    Java-Set-Jdk -Version 17
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java21 {
</span></span><span style=display:flex><span>    Java-Set-Jdk -Version 21
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Java-Maven-Repository-Soft-Link-Create(){
</span></span><span style=display:flex><span>    Link-Soft -VirtualPath <span style=color:#a31515>&#39;d:\_lang\_maven\repository&#39;</span> -RealPath <span style=color:#a31515>&#34;</span>${ENV:HOME_D}<span style=color:#a31515>\.m2\repository&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-6656e12c649a13d5aec9724e9a1de8f9><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-6656e12c649a13d5aec9724e9a1de8f9","highlight-file_opened")'>k8s.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/k8s.ps1 title="下载 k8s.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/k8s.ps1 title="源码 k8s.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://github.com/mziyabo/PSKubectlCompletion</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Kubernetes-ImportPSKubectlCompletion () {
</span></span><span style=display:flex><span>    Import-Module -Name PSKubectlCompletion
</span></span><span style=display:flex><span>    Register-KubectlCompletion
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Kubernetes-InstallPSKubectlCompletion () {
</span></span><span style=display:flex><span>    Install-Module PSKubectlCompletion
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Kubernetes-GetTerminatedPod() {
</span></span><span style=display:flex><span>    kubectl get pods -o custom-columns-file=D:\_code\blog\src\k8s\kubectl\terminated-pod.txt --sort-by=<span style=color:#a31515>&#39;{status.containerStatuses[0].lastState.terminated.finishedAt}&#39;</span> $Args
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-7675fbbd0adaf5edf77ab6242ebca45d><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-7675fbbd0adaf5edf77ab6242ebca45d","highlight-file_opened")'>link.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/link.ps1 title="下载 link.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/link.ps1 title="源码 link.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Link-Soft() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $VirtualPath,
</span></span><span style=display:flex><span>        [string] $RealPath
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;New-Item -ItemType SymbolicLink -Path </span>$VirtualPath<span style=color:#a31515> -Target </span>$RealPath<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    New-Item -ItemType SymbolicLink -Path $VirtualPath -Target $RealPath
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Link-Reset-Home {
</span></span><span style=display:flex><span>     <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $Path
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Link-Soft -VirtualPath <span style=color:#a31515>&#34;</span>${ENV:HOME}<span style=color:#a31515>\</span>${Path}<span style=color:#a31515>&#34;</span> -RealPath <span style=color:#a31515>&#34;</span>${ENV:HOME_D}<span style=color:#a31515>\</span>${Path}<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Link-Reset-Home-All {
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.android&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.dotnet&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.m2&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.ssh&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.vscode&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.nuget&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.gitconfig&#39;</span>
</span></span><span style=display:flex><span>    Link-Reset-Home -Path <span style=color:#a31515>&#39;.bash_history&#39;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-975b617c723c1134d9f909c4d8f890c7><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-975b617c723c1134d9f909c4d8f890c7","highlight-file_opened")'>log.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/log.ps1 title="下载 log.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/log.ps1 title="源码 log.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> Log-Warn() {
</span></span><span style=display:flex><span>    Write-Host $Args -ForegroundColor Yellow
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Log-Debug() {
</span></span><span style=display:flex><span>    Write-Host $Args -ForegroundColor Green
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Log-Info() {
</span></span><span style=display:flex><span>    Write-Host $Args -ForegroundColor Gray
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Log-NameValue(
</span></span><span style=display:flex><span>    [string] $Name,
</span></span><span style=display:flex><span>    [int] $NamePadding,
</span></span><span style=display:flex><span>    [string] $Value
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Write-Host -NoNewline $Name.PadRight($NamePadding)<span style=color:#a31515>&#34; : &#34;</span>
</span></span><span style=display:flex><span>    Write-Host $Value -ForegroundColor Green
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-4287f6c33a11d1bac6fc1d9b9de5a9f6><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-4287f6c33a11d1bac6fc1d9b9de5a9f6","highlight-file_opened")'>os.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/os.ps1 title="下载 os.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/os.ps1 title="源码 os.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell></code></pre></div></div></div><div class=highlight-file id=hfs-d768d46b64e5ed2557a4a5d6a612f053><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-d768d46b64e5ed2557a4a5d6a612f053","highlight-file_opened")'>profile.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/profile.ps1 title="下载 profile.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/profile.ps1 title="源码 profile.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell profile functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Profile-New(
</span></span><span style=display:flex><span>    [string] $ProfilePath = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;ProfilePath is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Test-Path $ProfilePath) {
</span></span><span style=display:flex><span>        Log-Info <span style=color:#a31515>&#34;# </span>$ProfilePath<span style=color:#a31515> already existed.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        New-Item -Path $Profile -ItemType File -Force
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;# Create [</span>$ProfilePath<span style=color:#a31515>] succeed.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Profile-AddScriptExpression (
</span></span><span style=display:flex><span>    [string] $ProfilePath = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;ProfilePath is null!&#34;</span>),
</span></span><span style=display:flex><span>    [string] $ScriptExpression = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;ScriptExpression is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Profile-New -ProfilePath $ProfilePath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $ProfileContent = Get-Content -Path $ProfilePath
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($ProfileContent -contains $ScriptExpression) {
</span></span><span style=display:flex><span>        Log-Info <span style=color:#a31515>&#34;# [</span>$ScriptExpression<span style=color:#a31515>] already existed in </span>$ProfilePath<span style=color:#a31515>.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        Set-Content -Path $ProfilePath -Value <span style=color:#a31515>&#34;</span>$ProfileContent<span style=color:#a31515>`r`n</span>$ScriptExpression<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;# [</span>$ScriptExpression<span style=color:#a31515>] append to </span>$ProfilePath<span style=color:#a31515>.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Profile-AddScriptFile (
</span></span><span style=display:flex><span>    [string] $ProfilePath = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;ProfilePath is null!&#34;</span>),
</span></span><span style=display:flex><span>    [string] $ScriptFilePath = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;ScriptFilePath is null!&#34;</span>)
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (!(Test-Path $ScriptFilePath)) {
</span></span><span style=display:flex><span>        <span style=color:#00f>throw</span> <span style=color:#a31515>&#34;</span>$ScriptFilePath<span style=color:#a31515> not found.&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Profile-AddScriptExpression -ProfilePath $ProfilePath -ScriptExpression <span style=color:#a31515>&#34;. &#34;&#34;</span>$ScriptFilePath<span style=color:#a31515>&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-6e42c3ca78bbb582b9000f4f2ee8ccc2><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-6e42c3ca78bbb582b9000f4f2ee8ccc2","highlight-file_opened")'>prompt.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/prompt.ps1 title="下载 prompt.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/prompt.ps1 title="源码 prompt.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell prompt functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> prompt () {
</span></span><span style=display:flex><span>    <span style=color:green># hold last exit code</span>
</span></span><span style=display:flex><span>    $OLD_LASTEXITCODE = $LASTEXITCODE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Now = [System.DateTimeOffset]::Now
</span></span><span style=display:flex><span>    $CurrentYearLastDay = New-Object -TypeName System.DateOnly -ArgumentList ($Now.Year, 12, 31)
</span></span><span style=display:flex><span>    $DateTime = $Now.ToString(<span style=color:#a31515>&#39;yy-MM-dd HH:mm:ss K&#39;</span>)
</span></span><span style=display:flex><span>    $DayOfWeek = [System.Int32]$Now.DayOfWeek
</span></span><span style=display:flex><span>    $Week = $DayOfWeek.Equals(0)<span style=color:#00f>?</span>7<span>:</span>$DayOfWeek
</span></span><span style=display:flex><span>    $DayOfYear = $Now.DayOfYear
</span></span><span style=display:flex><span>    $WeekOfYear = [System.Math]::Round(($DayOfYear + 7) / 7)
</span></span><span style=display:flex><span>    $ResidueWeekOfYear = [System.Math]::Round(($CurrentYearLastDay.DayOfYear - $DayOfYear) / 7)
</span></span><span style=display:flex><span>    $DayOfNewYear = $CurrentYearLastDay.DayOfYear - $DayOfYear
</span></span><span style=display:flex><span>    $UnixTimeMilliseconds = $Now.ToUnixTimeMilliseconds()
</span></span><span style=display:flex><span>    $UserPrompt = UI-GetUserPrompt
</span></span><span style=display:flex><span>    $UserPromptPrefix = $UserPrompt.Prefix
</span></span><span style=display:flex><span>    $UserPromptText = $UserPrompt.Text
</span></span><span style=display:flex><span>    $UserPromptCurrentPath = $UserPrompt.CurrentPath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Write-Host -NoNewline <span style=color:#a31515>&#34;</span><span style=color:#a31515>`n</span>$UserPromptPrefix<span style=color:#a31515> </span>$UserPromptCurrentPath<span style=color:#a31515> </span>$DateTime<span style=color:#a31515> </span>$UnixTimeMilliseconds<span style=color:#a31515> w</span>$Week<span style=color:#a31515>-</span>$WeekOfYear<span style=color:#a31515>-</span>$ResidueWeekOfYear<span style=color:#a31515> d</span>$DayOfYear<span style=color:#a31515>-</span>$DayOfNewYear<span style=color:#a31515>&#34;</span> -ForegroundColor Gray
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($OLD_LASTEXITCODE -gt 0) {
</span></span><span style=display:flex><span>        Write-Host -NoNewline <span style=color:#a31515>&#34; </span>$OLD_LASTEXITCODE<span style=color:#a31515>&#34;</span> -ForegroundColor Red
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># if working directory is git repository</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Get-GitStatus) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:green># get git user.name and user.email</span>
</span></span><span style=display:flex><span>        $GitUser = Git-GetCurrentUser
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:green># show git user.name and user.email</span>
</span></span><span style=display:flex><span>        Write-Host -NoNewline <span style=color:#a31515>&#34;</span><span style=color:#a31515>`n</span>$UserPromptPrefix<span style=color:#a31515> </span>$GitUser<span style=color:#a31515> :&#34;</span> -ForegroundColor Gray
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:green># show git status</span>
</span></span><span style=display:flex><span>        Write-Host -NoNewline (Write-VcsStatus)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Write-Host
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># show current work directory in window title</span>
</span></span><span style=display:flex><span>    <span style=color:green># $Host.UI.RawUI.WindowTitle = $UserPromptText</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># reset last exit code</span>
</span></span><span style=display:flex><span>    $LASTEXITCODE = $OLD_LASTEXITCODE
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> <span style=color:#a31515>&#34;</span>$UserPromptPrefix<span style=color:#a31515> &#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-f367ad41a75c27379312f62f59280f8d><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-f367ad41a75c27379312f62f59280f8d","highlight-file_opened")'>sln.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/sln.ps1 title="下载 sln.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/sln.ps1 title="源码 sln.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>########################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell open visual studio sln file</span>
</span></span><span style=display:flex><span><span style=color:green>########################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Sln-GetFiles() {
</span></span><span style=display:flex><span>    $currentPath = Get-Location
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;current path : &#39;</span> $currentPath
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $slnFiles = Get-ChildItem -Path $currentPath -File -Filter *.sln
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $slnFiles
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:Sln-SelectFile($slnFiles) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($slnFiles.Count -eq 0) {
</span></span><span style=display:flex><span>        <span style=color:#00f>throw</span> <span style=color:#a31515>&#39;sln file not found.&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($slnFiles.Count -eq 1) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> $slnFiles[0]
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [int]$i = 0
</span></span><span style=display:flex><span>    $slnFiles | ForEach-Object {
</span></span><span style=display:flex><span>        Write-Host $i <span style=color:#a31515>&#39;: &#39;</span> $_.Name
</span></span><span style=display:flex><span>        $i++
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [int]$index = Read-Host <span style=color:#a31515>&#39;find more sln file, please input index (default 0) :&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $slnFiles[$index]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Sln() {
</span></span><span style=display:flex><span>    $slnFiles = Sln-GetFiles
</span></span><span style=display:flex><span>    $slnFile = Sln-SelectFile $slnFiles
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#39;opening...   : &#39;</span> $slnFile
</span></span><span style=display:flex><span>    Invoke-Item $slnFile
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-bd521069e620d539dabeb1ff03c3f489><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-bd521069e620d539dabeb1ff03c3f489","highlight-file_opened")'>ui.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/ui.ps1 title="下载 ui.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/ui.ps1 title="源码 ui.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell ui functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Ui-Test-Administrator {
</span></span><span style=display:flex><span>    $CurrentUser = [Security.Principal.WindowsIdentity]::GetCurrent();
</span></span><span style=display:flex><span>    $CurrentPrincipal = New-Object Security.Principal.WindowsPrincipal $CurrentUser;
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $CurrentPrincipal.IsInRole([Security.Principal.WindowsBuiltinRole]::Administrator)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:UI-GetUserName() {
</span></span><span style=display:flex><span>    $UserName = $ENV:USERNAME.ToLower();
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($UserName -eq <span style=color:#a31515>&#39;administrator&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span> <span style=color:#a31515>&#39;admin&#39;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $UserName;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> script:UI-GetComputerName() {
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> $ENV:COMPUTERNAME.ToLower();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> UI-GetUserPrompt() {
</span></span><span style=display:flex><span>    $Role = <span style=color:#a31515>&#39;$&#39;</span>;
</span></span><span style=display:flex><span>    $UserName = UI-GetUserName
</span></span><span style=display:flex><span>    $ComputerName = UI-GetComputerName
</span></span><span style=display:flex><span>    $CurrentPath = $(Get-Location).ToString().ToLower();
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Ui-Test-Administrator) {
</span></span><span style=display:flex><span>        $Role = <span style=color:#a31515>&#39;#&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>return</span> @{
</span></span><span style=display:flex><span>        Prefix       = $Role;
</span></span><span style=display:flex><span>        UserName     = $UserName;
</span></span><span style=display:flex><span>        ComputerName = $ComputerName;
</span></span><span style=display:flex><span>        CurrentPath  = $CurrentPath;
</span></span><span style=display:flex><span>        Text         = <span style=color:#a31515>&#34;</span>$Role<span style=color:#a31515> </span>$UserName<span style=color:#a31515>@</span>$ComputerName<span style=color:#a31515> </span>$CurrentPath<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> UI-SetDisplayOptions () {
</span></span><span style=display:flex><span>    $Host.UI.RawUI.WindowPosition.X = 0;
</span></span><span style=display:flex><span>    $Host.UI.RawUI.WindowPosition.Y = 0;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Host.UI.RawUI.BufferSize.Width = 80;
</span></span><span style=display:flex><span>    $Host.UI.RawUI.BufferSize.Height = 2000;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Host.UI.RawUI.WindowSize.Width = 80;
</span></span><span style=display:flex><span>    $Host.UI.RawUI.WindowSize.Height = 40;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Host.UI.RawUI.MaxWindowSize.Width = 80;
</span></span><span style=display:flex><span>    $Host.UI.RawUI.MaxWindowSize.Height = 40;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Host.UI.RawUI.ForegroundColor = <span style=color:#a31515>&#34;White&#34;</span>;
</span></span><span style=display:flex><span>    $Host.UI.RawUI.BackgroundColor = <span style=color:#a31515>&#34;Black&#34;</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-946b53b9ee95ad280164362bbcc4d9bf><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-946b53b9ee95ad280164362bbcc4d9bf","highlight-file_opened")'>v2ray.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/v2ray.ps1 title="下载 v2ray.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/v2ray.ps1 title="源码 v2ray.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> V2Ray-Upload-InstallScript {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $ServerHost,
</span></span><span style=display:flex><span>        [bool] $DryRun = $False
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-DEBUG <span style=color:#a31515>&#34;scp </span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>d:\_code\blog\src\tool\v2ray\init.sh</span><span style=color:#a31515>`&#34;</span><span style=color:#a31515> </span>${ServerHost}<span style=color:#a31515>:~/v2ray-init.sh&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($DryRun -eq $false) {
</span></span><span style=display:flex><span>        scp <span style=color:#a31515>&#34;d:\_code\blog\src\tool\v2ray\init.sh&#34;</span> <span style=color:#a31515>&#34;</span>${ServerHost}<span style=color:#a31515>:~/v2ray-init.sh&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> V2Ray-Download-ClientConfig {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $ServerHost,
</span></span><span style=display:flex><span>        [bool] $DryRun = $False
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-DEBUG <span style=color:#a31515>&#34;scp </span>${ServerHost}<span style=color:#a31515>:~/v2ray-client-config.json </span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>d:/_app/_v2ray/</span>${ServerHost}<span style=color:#a31515>-config.json</span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($DryRun -eq $false) {
</span></span><span style=display:flex><span>        scp <span style=color:#a31515>&#34;</span>${ServerHost}<span style=color:#a31515>:~/v2ray-client-config.json&#34;</span> <span style=color:#a31515>&#34;d:/_app/_v2ray/</span>${ServerHost}<span style=color:#a31515>-config.json&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> V2Ray-Upload-ClientConfig {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $ServerHost,
</span></span><span style=display:flex><span>        [string] $ClientHost,
</span></span><span style=display:flex><span>        [bool] $DryRun = $False
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    Log-DEBUG <span style=color:#a31515>&#34;scp </span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>d:/_app/_v2ray/</span>${ServerHost}<span style=color:#a31515>-config.json</span><span style=color:#a31515>`&#34;</span><span style=color:#a31515> </span>${ClientHost}<span style=color:#a31515>:/etc/config/v2ray.json&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($DryRun -eq $false) {
</span></span><span style=display:flex><span>        scp <span style=color:#a31515>&#34;d:/_app/_v2ray/</span>${ServerHost}<span style=color:#a31515>-config.json&#34;</span> <span style=color:#a31515>&#34;</span>${ClientHost}<span style=color:#a31515>:/etc/config/v2ray.json&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> V2Ray-Init-Server-And-Client {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $ServerHost,
</span></span><span style=display:flex><span>        [string] $ClientHost = <span style=color:#a31515>&#34;root@192.168.2.123&#34;</span>,
</span></span><span style=display:flex><span>        [bool] $DryRun = $False
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    $ServerIP = ($ServerHost -split <span style=color:#a31515>&#39;@&#39;</span>)[-1]
</span></span><span style=display:flex><span>    $ClientIP = ($ClientHost -split <span style=color:#a31515>&#39;@&#39;</span>)[-1]
</span></span><span style=display:flex><span>    V2Ray-Upload-InstallScript -ServerHost $ServerHost -DryRun $DryRun
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $InstallCommand = <span style=color:#a31515>&#34;chmod +x ./v2ray-init.sh;./v2ray-init.sh </span>${ServerIP}<span style=color:#a31515> </span>${ClientIP}<span style=color:#a31515>;exit&#34;</span>
</span></span><span style=display:flex><span>    Log-DEBUG <span style=color:#a31515>&#34;ssh </span>${ServerHost}<span style=color:#a31515> </span><span style=color:#a31515>`&#34;</span>${InstallCommand}<span style=color:#a31515>`&#34;</span><span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($DryRun -eq $False) {
</span></span><span style=display:flex><span>        ssh -t ${ServerHost} <span style=color:#a31515>&#34;</span>${InstallCommand}<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    V2Ray-Download-ClientConfig -ServerHost $ServerHost -DryRun $DryRun
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    V2Ray-Upload-ClientConfig -ServerHost $ServerHost -ClientHost $ClientHost -DryRun $DryRun
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Log-DEBUG <span style=color:#a31515>&#34;ssh </span>$ClientHost<span style=color:#a31515> </span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>reboot</span><span style=color:#a31515>`&#34;</span><span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($DryRun -eq $False) {
</span></span><span style=display:flex><span>        ssh -t $ClientHost <span style=color:#a31515>&#34;reboot&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-63371fadb4bafbc147708cc5530befcd><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-63371fadb4bafbc147708cc5530befcd","highlight-file_opened")'>vm.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/vm.ps1 title="下载 vm.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/vm.ps1 title="源码 vm.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span><span style=color:green># powershell vm(hyper-v) functions</span>
</span></span><span style=display:flex><span><span style=color:green>################################</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> vm ([string] $name) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ([String]::IsNullOrEmpty($name)) {
</span></span><span style=display:flex><span>        Get-VM
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        Get-VM -Name $name
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/hyper-v/new-vhd?view=win10-ps</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> vhd-create(
</span></span><span style=display:flex><span>    [string] $Path,
</span></span><span style=display:flex><span>    [uint64] $Size = 128GB
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;New-VHD -Dynamic -Path </span>$Path<span style=color:#a31515> -SizeBytes </span>$Size<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    New-VHD `
</span></span><span style=display:flex><span>        -Dynamic `
</span></span><span style=display:flex><span>        -Path $Path `
</span></span><span style=display:flex><span>        -SizeBytes $Size
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green># https://www.altaro.com/hyper-v/customize-vm-powershell/</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/hyper-v/new-vm?view=win10-ps</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/hyper-v/set-vm?view=win10-ps</span>
</span></span><span style=display:flex><span><span style=color:green># https://docs.microsoft.com/en-us/powershell/module/hyper-v/set-vmdvddrive?view=win10-ps</span>
</span></span><span style=display:flex><span><span style=color:green># https://learn.microsoft.com/zh-cn/windows-server/virtualization/hyper-v/best-practices-for-running-linux-on-hyper-v</span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Vm-From-Json(
</span></span><span style=display:flex><span>    [string] $JsonFilePath
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    $NamePadding = 22
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Test-Path -Path $JsonFilePath -PathType Leaf) -eq $False) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;not_found&#39;</span> -NamePadding $NamePadding -Value <span style=color:#a31515>&#34;</span>$JsonFilePath<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;help&#39;</span> -NamePadding $NamePadding -Value <span style=color:#a31515>&#39;https://linianhui.github.io/powershell/hyper-v/#config&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Ui-Test-Administrator) -eq $False) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;no_permission&#39;</span> -NamePadding $NamePadding -Value <span style=color:#a31515>&#34;need use administrator&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Json = Get-Content -Path $JsonFilePath | ConvertFrom-Json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $VhdPath = ($Json.vhd.path + <span style=color:#a31515>&#34;\&#34;</span> + $Json.name + <span style=color:#a31515>&#34;.vhdx&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Test-Path -Path $VhdPath -PathType Leaf) -eq $False) {
</span></span><span style=display:flex><span>        New-VHD `
</span></span><span style=display:flex><span>            -Dynamic `
</span></span><span style=display:flex><span>            -Path $VhdPath `
</span></span><span style=display:flex><span>            -BlockSizeBytes $Json.vhd.blockSize `
</span></span><span style=display:flex><span>            -SizeBytes $Json.vhd.size | Out-Null
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $VM = Get-VM -Name $Json.name -ErrorAction Ignore
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($VM -eq $NULL) {
</span></span><span style=display:flex><span>        New-VM `
</span></span><span style=display:flex><span>            -Name $Json.name `
</span></span><span style=display:flex><span>            -Generation $Json.generation `
</span></span><span style=display:flex><span>            -Path $Json.path `
</span></span><span style=display:flex><span>            -SwitchName $Json.net.<span style=color:#00f>switch</span> `
</span></span><span style=display:flex><span>            -VHDPath $VhdPath | Out-Null
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($VM.Generation -eq 2) {
</span></span><span style=display:flex><span>        <span style=color:green># https://learn.microsoft.com/en-us/powershell/module/hyper-v/set-vmfirmware?view=windowsserver2019-ps</span>
</span></span><span style=display:flex><span>        Set-VMFirmware `
</span></span><span style=display:flex><span>            -VMName $Json.name `
</span></span><span style=display:flex><span>            -EnableSecureBoot $Json.boot.secure
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># https://learn.microsoft.com/en-us/powershell/module/hyper-v/set-vm?view=windowsserver2019-ps</span>
</span></span><span style=display:flex><span>    Set-VM `
</span></span><span style=display:flex><span>        -Name $Json.name `
</span></span><span style=display:flex><span>        -AutomaticStartAction $Json.automatic.start `
</span></span><span style=display:flex><span>        -AutomaticStopAction $Json.automatic.stop `
</span></span><span style=display:flex><span>        -AutomaticCheckpointsEnabled $Json.automatic.checkpoint `
</span></span><span style=display:flex><span>        -CheckpointType $Json.checkpoint.type
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Get-VMIntegrationService -VMName $Json.name | ForEach-Object {
</span></span><span style=display:flex><span>        Enable-VMIntegrationService -VMName $Json.name -Name $_.Name
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># print vm</span>
</span></span><span style=display:flex><span>    $VM = Get-VM -Name $Json.name
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;name&#39;</span> -NamePadding $NamePadding -Value $VM.Name
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;generation&#39;</span> -NamePadding $NamePadding -Value $VM.Generation
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;path&#39;</span> -NamePadding $NamePadding -Value $VM.Path
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;state&#39;</span> -NamePadding $NamePadding -Value $VM.State
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($VM.Generation -eq 2) {
</span></span><span style=display:flex><span>        $VMFirmware = Get-VMFirmware -VMName $Json.name
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;boot.secure&#39;</span> -NamePadding $NamePadding -Value $VMFirmware.SecureBoot.ToString()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>else</span> {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;boot.secure&#39;</span> -NamePadding $NamePadding -Value <span style=color:#a31515>&#39;Off&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;automatic.start&#39;</span> -NamePadding $NamePadding -Value $VM.AutomaticStartAction
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;automatic.stop&#39;</span> -NamePadding $NamePadding -Value $VM.AutomaticStopAction
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;automatic.checkpoint&#39;</span> -NamePadding $NamePadding -Value $VM.AutomaticCheckpointsEnabled
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;checkpoint.type&#39;</span> -NamePadding $NamePadding -Value $VM.CheckpointType
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># https://learn.microsoft.com/en-us/powershell/module/hyper-v/set-vmprocessor?view=windowsserver2019-ps</span>
</span></span><span style=display:flex><span>    Set-VMProcessor `
</span></span><span style=display:flex><span>        -VMName $Json.name `
</span></span><span style=display:flex><span>        -Count $Json.cpu.count
</span></span><span style=display:flex><span>    $CPU = Get-VMProcessor -VMName $Json.name
</span></span><span style=display:flex><span>    <span style=color:green># print cpu</span>
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;cpu.count&#39;</span> -NamePadding $NamePadding -Value $CPU.Count
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green># https://learn.microsoft.com/en-us/powershell/module/hyper-v/set-vmmemory?view=windowsserver2019-ps</span>
</span></span><span style=display:flex><span>    Set-VMMemory `
</span></span><span style=display:flex><span>        -VMName $Json.name `
</span></span><span style=display:flex><span>        -DynamicMemoryEnabled $True `
</span></span><span style=display:flex><span>        -StartupBytes $Json.mem.min `
</span></span><span style=display:flex><span>        -MinimumBytes $Json.mem.min `
</span></span><span style=display:flex><span>        -MaximumBytes $Json.mem.max
</span></span><span style=display:flex><span>    $MEM = Get-VMMemory -VMName $Json.name
</span></span><span style=display:flex><span>    <span style=color:green># print mem</span>
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;mem.dynamic&#39;</span> -NamePadding $NamePadding -Value $MEM.DynamicMemoryEnabled
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;mem.startup&#39;</span> -NamePadding $NamePadding -Value ($MEM.Startup | Byte-Format)
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;mem.min&#39;</span> -NamePadding $NamePadding -Value ($MEM.Minimum | Byte-Format)
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;mem.max&#39;</span> -NamePadding $NamePadding -Value ($MEM.Maximum | Byte-Format)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Json.net.mac) {
</span></span><span style=display:flex><span>        Set-VMNetworkAdapter `
</span></span><span style=display:flex><span>            -VMName $Json.name `
</span></span><span style=display:flex><span>            -StaticMacAddress $Json.net.mac
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    $VM = Get-VM -Name $Json.name
</span></span><span style=display:flex><span>    <span style=color:green># print net</span>
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;net.switch&#39;</span> -NamePadding $NamePadding -Value $VM.NetworkAdapters[0].SwitchName
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;net.connected&#39;</span> -NamePadding $NamePadding -Value $VM.NetworkAdapters[0].Connected
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;net.mac&#39;</span> -NamePadding $NamePadding -Value ($VM.NetworkAdapters[0].MacAddress | Mac-Format)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $VHD = Get-VHD -Path $VhdPath
</span></span><span style=display:flex><span>    $HDD = Get-VMHardDiskDrive -VMName $Json.name
</span></span><span style=display:flex><span>    <span style=color:green># print hdd</span>
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.type&#39;</span> -NamePadding $NamePadding -Value $VHD.VhdType
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.path&#39;</span> -NamePadding $NamePadding -Value $VHD.Path
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.format&#39;</span> -NamePadding $NamePadding -Value $VHD.VhdFormat
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.size&#39;</span> -NamePadding $NamePadding -Value ($VHD.Size | Byte-Format)
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.blocksize&#39;</span> -NamePadding $NamePadding -Value ($VHD.BlockSize | Byte-Format)
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.fileSize&#39;</span> -NamePadding $NamePadding -Value ($VHD.FileSize | Byte-Format)
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.controllerType&#39;</span> -NamePadding $NamePadding -Value $HDD.ControllerType
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.controllerNumber&#39;</span> -NamePadding $NamePadding -Value $HDD.ControllerNumber
</span></span><span style=display:flex><span>    Log-NameValue -Name <span style=color:#a31515>&#39;vhd.controllerLocation&#39;</span> -NamePadding $NamePadding -Value $HDD.ControllerLocation
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($Json.dvd.iso) {
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> (Test-Path -Path $Json.dvd.iso -PathType Leaf) {
</span></span><span style=display:flex><span>            <span style=color:#00f>if</span> ((Get-VMDvdDrive -VMName $Json.name) -eq $Null) {
</span></span><span style=display:flex><span>                Add-VMDvdDrive `
</span></span><span style=display:flex><span>                    -VMName $Json.name `
</span></span><span style=display:flex><span>                    -Path $Json.dvd.iso`
</span></span><span style=display:flex><span>                    -ErrorAction Ignore
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $DVD = Get-VMDvdDrive -VMName $Json.name
</span></span><span style=display:flex><span>        <span style=color:#00f>if</span> ($DVD.Path) {
</span></span><span style=display:flex><span>            <span style=color:green># print dvd</span>
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.type&#39;</span> -NamePadding $NamePadding -Value $DVD.DvdMediaType
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.path&#39;</span> -NamePadding $NamePadding -Value $DVD.Path
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.fileSize&#39;</span> -NamePadding $NamePadding -Value ((Get-Item $DVD.Path).Length | Byte-Format)
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.controllerType&#39;</span> -NamePadding $NamePadding -Value $DVD.ControllerType
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.controllerNumber&#39;</span> -NamePadding $NamePadding -Value $DVD.ControllerNumber
</span></span><span style=display:flex><span>            Log-NameValue -Name <span style=color:#a31515>&#39;dvd.controllerLocation&#39;</span> -NamePadding $NamePadding -Value $DVD.ControllerLocation
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Vm-To-Json() {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [string] $VMName = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;VMName is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $NamePadding = 22
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Ui-Test-Administrator) -eq $False) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;no_permission&#39;</span> -NamePadding $NamePadding -Value <span style=color:#a31515>&#39;need use administrator&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $VM = Get-VM -Name $VMName -ErrorAction Ignore
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($VM -eq $NULL) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;not_found&#39;</span> -NamePadding $NamePadding -Value $VMName
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $AutomaticJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;start&#39;</span>      = $VM.AutomaticStartAction.ToString()
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;stop&#39;</span>       = $VM.AutomaticStopAction.ToString()
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;checkpoint&#39;</span> = $VM.AutomaticCheckpointsEnabled
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $CheckpointJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;type&#39;</span> = $VM.CheckpointType.ToString()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $BootJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;secure&#39;</span> = <span style=color:#a31515>&#39;Off&#39;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ($VM.Generation -eq 2) {
</span></span><span style=display:flex><span>        $Boot = Get-VMFirmware -VMName $VM.Name
</span></span><span style=display:flex><span>        $BootJson.secure = $Boot.SecureBoot.ToString()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Cpu = Get-VMProcessor -VMName $VM.Name
</span></span><span style=display:flex><span>    $CpuJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;count&#39;</span> = $Cpu.Count
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Mem = Get-VMMemory -VMName $VM.Name
</span></span><span style=display:flex><span>    $MemJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;min&#39;</span> = ($Mem.Minimum | Byte-Format)
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;max&#39;</span> = ($Mem.Maximum | Byte-Format)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $NetJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;switch&#39;</span> = $VM.NetworkAdapters[0].SwitchName
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;mac&#39;</span>    = ($VM.NetworkAdapters[0].MacAddress | Mac-Format)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $VhdPath = (Get-VMHardDiskDrive -VMName $VM.Name)[0].Path
</span></span><span style=display:flex><span>    $Vhd = Get-VHD -Path $VhdPath
</span></span><span style=display:flex><span>    $VhdJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;path&#39;</span>      = (Get-ChildItem -Path $Vhd.Path).DirectoryName.ToLower()
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;size&#39;</span>      = ($Vhd.Size | Byte-Format)
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;blockSize&#39;</span> = ($Vhd.BlockSize | Byte-Format)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Dvd = Get-VMDvdDrive -VMName $VM.Name
</span></span><span style=display:flex><span>    $DvdJson = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#34;iso&#34;</span> = $Dvd.Path?.ToLower()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Json = [ordered]@{
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;name&#39;</span>       = $VM.Name
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;generation&#39;</span> = $VM.Generation
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;path&#39;</span>       = $VM.Path.ToLower()
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;automatic&#39;</span>  = $AutomaticJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;boot&#39;</span>       = $BootJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;checkpoint&#39;</span> = $CheckpointJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;cpu&#39;</span>        = $CpuJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;mem&#39;</span>        = $MemJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;net&#39;</span>        = $NetJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;vhd&#39;</span>        = $VhdJson
</span></span><span style=display:flex><span>        <span style=color:#a31515>&#39;dvd&#39;</span>        = $DvdJson
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    $Json | ConvertTo-Json
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> vm-run ([string] $name) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Ui-Test-Administrator) -eq $False) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;no_permission&#39;</span> -NamePadding 20 -Value <span style=color:#a31515>&#39;use administrator run vm&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    Get-VM -Name $name | Start-VM
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> vm-stop ([string] $name) {
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> ((Ui-Test-Administrator) -eq $False) {
</span></span><span style=display:flex><span>        Log-NameValue -Name <span style=color:#a31515>&#39;no_permission&#39;</span> -NamePadding 10 -Value <span style=color:#a31515>&#39;use administrator stop vm&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#00f>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    Get-VM -Name $name | Stop-VM
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> vm-ssh (
</span></span><span style=display:flex><span>    [string]$username,
</span></span><span style=display:flex><span>    [string]$hostname,
</span></span><span style=display:flex><span>    [string]$port = 22) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;run [</span>$hostname<span style=color:#a31515>] hyper-v vm&#34;</span>
</span></span><span style=display:flex><span>    vm-run -name $hostname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;ssh </span>$username<span style=color:#a31515>@</span>$hostname<span style=color:#a31515> -p </span>$port<span style=color:#a31515>&#34;</span>
</span></span><span style=display:flex><span>    ssh <span style=color:#a31515>&#34;</span>$username<span style=color:#a31515>@</span>$hostname<span style=color:#a31515>&#34;</span> -p $port
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> ubt1 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname ubt1
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> ubt2 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname ubt2
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> ubt3 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname ubt3
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> ceos () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname ceos
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> deb1 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname deb1
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> deb2 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname deb2
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> deb3 () {
</span></span><span style=display:flex><span>    vm-ssh -username root -hostname deb3
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-c9e82ef09aeeaa608918f990a562a2d8><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-c9e82ef09aeeaa608918f990a562a2d8","highlight-file_opened")'>vscode.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/vscode.ps1 title="下载 vscode.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/vscode.ps1 title="源码 vscode.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> VsCode-Open {
</span></span><span style=display:flex><span>    <span style=color:#00f>param</span> (
</span></span><span style=display:flex><span>        [Parameter(Mandatory = $TRUE)]
</span></span><span style=display:flex><span>        [string] $Path = $(<span style=color:#00f>throw</span> <span style=color:#a31515>&#34;Path param is null!&#34;</span>)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>    <span style=color:#00f>if</span> (Directory-Exists-And-Is-Directory -Path $Path) {
</span></span><span style=display:flex><span>        Log-Debug <span style=color:#a31515>&#34;code </span>$Path<span style=color:#a31515>&#34;</span>.ToLower()
</span></span><span style=display:flex><span>        code $Path
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-aff3d6bf689b7c7baa2e56ed23c8e26c><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-aff3d6bf689b7c7baa2e56ed23c8e26c","highlight-file_opened")'>wlan.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/wlan.ps1 title="下载 wlan.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/wlan.ps1 title="源码 wlan.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#00f>function</span> WLAN-Export {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;netsh wlan export profile key=clear&#34;</span>
</span></span><span style=display:flex><span>    netsh wlan export profile key=clear
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div><div class=highlight-file id=hfs-f5d898edb5e15ccd30420bd347336cb4><div class=highlight-file-header><a class="fa fa-plus highlight-file-switch" onclick='blog.toggleClassName("hfs-f5d898edb5e15ccd30420bd347336cb4","highlight-file_opened")'>yaml.ps1</a>
<a class="fa fa-download highlight-file-download" target=_blank href=/powershell/script/yaml.ps1 title="下载 yaml.ps1" download></a><a class="fa fa-github" target=_blank href=https://github.com/linianhui/blog/blob/main/src/powershell/script/yaml.ps1 title="源码 yaml.ps1"></a></div><div class=highlight-file-content><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:green># https://github.com/jeremyfa/yaml.js</span>
</span></span><span style=display:flex><span><span style=color:green># cnpm install -yamljs -g</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Yaml-ToJson() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;yaml2json --pretty --indentation 2&#34;</span> $Args
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    yaml2json --pretty --indentation 2 $Args
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>function</span> Yaml-FromJson() {
</span></span><span style=display:flex><span>    Log-Debug <span style=color:#a31515>&#34;json2yaml --depth 64 --indentation 2&#34;</span> $Args
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    json2yaml --depth 64 --indentation 2 $Args
</span></span><span style=display:flex><span>}</span></span></code></pre></div></div></div></div></div></section><section class=article-meta><section class=article-date>2017-07-29 09:42，约6460字，阅读约13分钟</section><section class=article-topics><a class=article-topic href=/powershell/ title=[PowerShell] target=_blank><i class="fa fa-folder"></i>[PowerShell]</a></section><section class=article-tags><a class=article-tag href=/tag/powershell target=_blank><i class="fa fa-tag"></i>PowerShell</a>
<a class=article-tag href=/tag/ps1 target=_blank><i class="fa fa-tag"></i>ps1</a></section><section class=article-git><a class=article-git-commit href=https://github.com/linianhui/blog/commit/f5b959920f4bbd68096f521b5a817de6391648bd target=_blank><i class="fa fa-code-fork"></i>f5b9599</a>
<span class=article-git-commit-subject>add bios</span>
<span class=article-git-commit-time>2025-10-16 22:27</span>
<a class=article-git-source href=https://github.com/linianhui/blog/blob/main/src/powershell/script/index.md target=_blank><i class="fa fa-github"></i>源码</a></section></section><section class=article-page><div class=article-page-prev><span>上一篇 : </span><a href=/powershell/help/ target=_blank>[PowerShell] Help</a></div><div class=article-page-next><span>下一篇 : </span><a href=/powershell/hyper-v/ target=_blank>[PowerShell] Hyper-V</a></div></section></article><section id=article-comment class=article-comment><script src=https://utteranc.es/client.js repo=linianhui/blog issue-term=pathname label=blog-comment theme=github-light crossorigin=anonymous async></script></section></main><footer class=footer><section>Copyright © 2026 by <a href=https://github.com/linianhui/blog target=_blank>Timetombs</a></section><section><a class=article-git-commit href=https://github.com/linianhui/blog/commit/39b6c03faec1d2881596df2cd2436da10cdf9eef target=_blank><i class="fa fa-code-fork"></i>39b6c03</a>
Powered by
<a href=https://github.com/actions target=_blank>GitHub Actions</a>
,
<a href=https://github.com/gohugoio/hugo target=_blank>Hugo</a>
and
<a href=https://github.com/utterance/utterances target=_blank>utterances</a>
Hosted on <a href=https://pages.github.com/ target=_blank>GitHub Pages</a><section></footer></main><aside class=toolbar><a class="fa fa-list" href=javascript:blog.toggleToc(); title=目录></a><a class="fa fa-comments" href=#article-comment title=评论></a><a class="fa fa-arrow-up" href=javascript:scroll(0,0); title=返回顶部></a></aside><script type=text/javascript>var _hmt=_hmt||[];blog.addOnScorllEvent()</script></body></html>